{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"6696303a99b64b8c996fc9c66fa08554":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_b3e42041b93f4877a3f3e3567b9e3430","IPY_MODEL_28e9ed63534642a18350b9dd2369be8e","IPY_MODEL_60918871ac054ab0aef4a1af7e877e9e"],"layout":"IPY_MODEL_3acd5ff322ba4065a162bf8babfe778c"}},"b3e42041b93f4877a3f3e3567b9e3430":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5ef98bb86b264c18bb344752f2b79920","placeholder":"​","style":"IPY_MODEL_e855dd643a794605923544984991b325","value":"Downloading data files: 100%"}},"28e9ed63534642a18350b9dd2369be8e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_417b0cbddc9640108cec2b9fb6010dcf","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_fc15553209344107b4a1a99281ddeb39","value":1}},"60918871ac054ab0aef4a1af7e877e9e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d60be604a5214e2a83e434868c3637ce","placeholder":"​","style":"IPY_MODEL_0641bd8b8a0e4d6f929a169b37c658e3","value":" 1/1 [00:00&lt;00:00, 24.11it/s]"}},"3acd5ff322ba4065a162bf8babfe778c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ef98bb86b264c18bb344752f2b79920":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e855dd643a794605923544984991b325":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"417b0cbddc9640108cec2b9fb6010dcf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fc15553209344107b4a1a99281ddeb39":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d60be604a5214e2a83e434868c3637ce":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0641bd8b8a0e4d6f929a169b37c658e3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"741ec8e2e6174c93919a312a046f285a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6a9ca7798fe74558abb732606d62b90c","IPY_MODEL_4cc355b6640a4eca98497fd24d9b0119","IPY_MODEL_4febd588fa504c418f33e79eeaf3cd20"],"layout":"IPY_MODEL_0eceb0ae7743428080b5f969cd6227fc"}},"6a9ca7798fe74558abb732606d62b90c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a52c171d733a4bb49d6bb1cb8f48c957","placeholder":"​","style":"IPY_MODEL_3101169dcfdc4e29b5ccc6794d02388b","value":"Extracting data files: 100%"}},"4cc355b6640a4eca98497fd24d9b0119":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f19460f42e594875a0fe5d7c75297e40","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_02c8ed23200a4ad5af46c3aaf3edf757","value":1}},"4febd588fa504c418f33e79eeaf3cd20":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_66e0f296c1ac4f0bb5f584473be50428","placeholder":"​","style":"IPY_MODEL_cfdebe2c3bf945018efe6274ec9ec820","value":" 1/1 [00:01&lt;00:00,  1.02s/it]"}},"0eceb0ae7743428080b5f969cd6227fc":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a52c171d733a4bb49d6bb1cb8f48c957":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3101169dcfdc4e29b5ccc6794d02388b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f19460f42e594875a0fe5d7c75297e40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"02c8ed23200a4ad5af46c3aaf3edf757":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"66e0f296c1ac4f0bb5f584473be50428":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cfdebe2c3bf945018efe6274ec9ec820":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"abe3e8a9d55c42aa96d44e445fb560f7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_fe968c15bdc54b8b92ae2e7473b704a5","IPY_MODEL_5af2fe21d9d84f999aee7c61aaddeebd","IPY_MODEL_a7184f1b494c4893be88280c0d7cedaa"],"layout":"IPY_MODEL_1266986f719a4c76b2ce439c1c98c927"}},"fe968c15bdc54b8b92ae2e7473b704a5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b9d72672a8014393be1da304c613b91a","placeholder":"​","style":"IPY_MODEL_7ab3f130f8b045bb9f7e81edad567a3a","value":"Generating train split: "}},"5af2fe21d9d84f999aee7c61aaddeebd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_c8e6a6a4c40548bba5fb806102bbce48","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d0a823db47314d78897072b058642c5d","value":1}},"a7184f1b494c4893be88280c0d7cedaa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0c3f2158a3784ca69c95d05524a2668e","placeholder":"​","style":"IPY_MODEL_1b4b16f58b76480a89a35b5b46c67701","value":" 0/0 [00:00&lt;?, ? examples/s]"}},"1266986f719a4c76b2ce439c1c98c927":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"b9d72672a8014393be1da304c613b91a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7ab3f130f8b045bb9f7e81edad567a3a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c8e6a6a4c40548bba5fb806102bbce48":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"d0a823db47314d78897072b058642c5d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0c3f2158a3784ca69c95d05524a2668e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1b4b16f58b76480a89a35b5b46c67701":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"066cbe97ab5841109e50683099323364":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_96c5b4ea8120424a874e0d47e7fa266f","IPY_MODEL_45351f9d32184c4d8409c5d0ede5302d","IPY_MODEL_f938c69168744ccf9fa99b9229d98774"],"layout":"IPY_MODEL_874ed587491441a8b544ad1ecd116a81"}},"96c5b4ea8120424a874e0d47e7fa266f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f116f78c659c4f158cc3713289e7c137","placeholder":"​","style":"IPY_MODEL_f7bdc15701fa44488f54e877503ab2b1","value":"100%"}},"45351f9d32184c4d8409c5d0ede5302d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_506449cfba4e4e1a98463b7c4c3f8be2","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_abeafb5e0f3e4356a1a8d5ffc47d4d0e","value":1}},"f938c69168744ccf9fa99b9229d98774":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37496a08a74d4c2b8e326672b5c2bbde","placeholder":"​","style":"IPY_MODEL_fed75d668b5b4000b5e5e650dd9f22bc","value":" 1/1 [00:00&lt;00:00, 35.33it/s]"}},"874ed587491441a8b544ad1ecd116a81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f116f78c659c4f158cc3713289e7c137":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7bdc15701fa44488f54e877503ab2b1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"506449cfba4e4e1a98463b7c4c3f8be2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"abeafb5e0f3e4356a1a8d5ffc47d4d0e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"37496a08a74d4c2b8e326672b5c2bbde":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fed75d668b5b4000b5e5e650dd9f22bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3addd517b56548bcb83598d5eff87789":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_529456eee8944a9a8313be4382a2320a","IPY_MODEL_3bb39ae69eb543419ddf7d0bd59514f8","IPY_MODEL_9cbc21741bae43b3b83080bb0c70a260"],"layout":"IPY_MODEL_e6524ad751c244cdaa1b0b372d57cd6c"}},"529456eee8944a9a8313be4382a2320a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_156fa1a7dbeb43549a6b7ee1b3a5fa87","placeholder":"​","style":"IPY_MODEL_96631c2d2185400fb3707510a975bd45","value":"Map: 100%"}},"3bb39ae69eb543419ddf7d0bd59514f8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_72ea940f2c54491d99dd268f9e6acd26","max":35,"min":0,"orientation":"horizontal","style":"IPY_MODEL_becce6db1eb348ca95ddd8cd7602687f","value":35}},"9cbc21741bae43b3b83080bb0c70a260":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d6d2387c30c34af1924435db4f277b0f","placeholder":"​","style":"IPY_MODEL_e10e4ce34ead4a3397e8eef1ed9d85fa","value":" 35/35 [00:00&lt;00:00, 242.53 examples/s]"}},"e6524ad751c244cdaa1b0b372d57cd6c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"156fa1a7dbeb43549a6b7ee1b3a5fa87":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"96631c2d2185400fb3707510a975bd45":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"72ea940f2c54491d99dd268f9e6acd26":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"becce6db1eb348ca95ddd8cd7602687f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d6d2387c30c34af1924435db4f277b0f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e10e4ce34ead4a3397e8eef1ed9d85fa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2400962c2c9842bfb5d793373cb52461":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_83719696c164420f8cad52641dfe9482","IPY_MODEL_e11528da4c7743bdb9a5708615df1678","IPY_MODEL_b95b5a5620334fc78e43919bc6fbe7dc"],"layout":"IPY_MODEL_2dd51b02e1c14cdd853f637bb9613ee5"}},"83719696c164420f8cad52641dfe9482":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_19d6503c0172422e879d6a63fc8b6759","placeholder":"​","style":"IPY_MODEL_ca4b0785f9ed4dc5ac549f460762b7ff","value":"Downloading (…)lve/main/config.json: 100%"}},"e11528da4c7743bdb9a5708615df1678":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_95ff1b0a2c5b4f328047090946715f19","max":430,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e24d7bddf628452caeb4f52b9fbdf125","value":430}},"b95b5a5620334fc78e43919bc6fbe7dc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4bc43db6bb63429d82b4ed773f680f00","placeholder":"​","style":"IPY_MODEL_913b59941ac74d63ba3e3c92a043035e","value":" 430/430 [00:00&lt;00:00, 11.2kB/s]"}},"2dd51b02e1c14cdd853f637bb9613ee5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"19d6503c0172422e879d6a63fc8b6759":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ca4b0785f9ed4dc5ac549f460762b7ff":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"95ff1b0a2c5b4f328047090946715f19":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e24d7bddf628452caeb4f52b9fbdf125":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4bc43db6bb63429d82b4ed773f680f00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"913b59941ac74d63ba3e3c92a043035e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3dc263df64994d758d80eebe2046c50e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_61271bdffa2340538b5387932061a8c6","IPY_MODEL_2cfa3134088545e5b5294d0645653890","IPY_MODEL_abffbd97cf504c59abfeee94aa6e3c32"],"layout":"IPY_MODEL_edb3af1ac02b484e8922612f1ae6d1b6"}},"61271bdffa2340538b5387932061a8c6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_077fc9315ee447a49cb557cd642ee4a4","placeholder":"​","style":"IPY_MODEL_180806a2add64e82b2674b2eae22ea88","value":"Downloading pytorch_model.bin: 100%"}},"2cfa3134088545e5b5294d0645653890":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b4b60a5651a043cf9780526a607a8b2d","max":470657952,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f0186437ad91448f93fc0f1c4658a9fa","value":470657952}},"abffbd97cf504c59abfeee94aa6e3c32":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_741135d8ca7e4ef985b41f14d7023daf","placeholder":"​","style":"IPY_MODEL_05fdea21cc0e41ecb6da0b21d0fe0552","value":" 471M/471M [00:02&lt;00:00, 257MB/s]"}},"edb3af1ac02b484e8922612f1ae6d1b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"077fc9315ee447a49cb557cd642ee4a4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"180806a2add64e82b2674b2eae22ea88":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b4b60a5651a043cf9780526a607a8b2d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f0186437ad91448f93fc0f1c4658a9fa":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"741135d8ca7e4ef985b41f14d7023daf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"05fdea21cc0e41ecb6da0b21d0fe0552":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"_BiM0RepL_H6","executionInfo":{"status":"ok","timestamp":1684925682064,"user_tz":-120,"elapsed":2101,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"ffd128cc-4dc7-4864-9e8b-86b6cd95b3a0"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["!pip install datasets transformers accelerate"],"metadata":{"id":"wCWqtrBkuBp9","executionInfo":{"status":"ok","timestamp":1684925690578,"user_tz":-120,"elapsed":8515,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"afcb2026-10ea-4d54-bef4-07b143bdb460"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: datasets in /usr/local/lib/python3.10/dist-packages (2.12.0)\n","Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.29.2)\n","Requirement already satisfied: accelerate in /usr/local/lib/python3.10/dist-packages (0.19.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Requirement already satisfied: dill<0.3.7,>=0.3.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.3.6)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.2.0)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from datasets) (0.70.14)\n","Requirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.8.4)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.14.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Requirement already satisfied: responses<0.19 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.18.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.13.3)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.0.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.2)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.3)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n"]}]},{"cell_type":"code","source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"],"metadata":{"id":"13dCqvZhuxs_","executionInfo":{"status":"ok","timestamp":1684925691632,"user_tz":-120,"elapsed":1063,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"3922e8fb-7cff-4464-dc6e-7fb2afcca851"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Wed May 24 10:54:50 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   46C    P8     9W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"],"metadata":{"id":"4evkaVy1u46V"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/N messages/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"output_10.csv\")\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":277,"referenced_widgets":["6696303a99b64b8c996fc9c66fa08554","b3e42041b93f4877a3f3e3567b9e3430","28e9ed63534642a18350b9dd2369be8e","60918871ac054ab0aef4a1af7e877e9e","3acd5ff322ba4065a162bf8babfe778c","5ef98bb86b264c18bb344752f2b79920","e855dd643a794605923544984991b325","417b0cbddc9640108cec2b9fb6010dcf","fc15553209344107b4a1a99281ddeb39","d60be604a5214e2a83e434868c3637ce","0641bd8b8a0e4d6f929a169b37c658e3","741ec8e2e6174c93919a312a046f285a","6a9ca7798fe74558abb732606d62b90c","4cc355b6640a4eca98497fd24d9b0119","4febd588fa504c418f33e79eeaf3cd20","0eceb0ae7743428080b5f969cd6227fc","a52c171d733a4bb49d6bb1cb8f48c957","3101169dcfdc4e29b5ccc6794d02388b","f19460f42e594875a0fe5d7c75297e40","02c8ed23200a4ad5af46c3aaf3edf757","66e0f296c1ac4f0bb5f584473be50428","cfdebe2c3bf945018efe6274ec9ec820","abe3e8a9d55c42aa96d44e445fb560f7","fe968c15bdc54b8b92ae2e7473b704a5","5af2fe21d9d84f999aee7c61aaddeebd","a7184f1b494c4893be88280c0d7cedaa","1266986f719a4c76b2ce439c1c98c927","b9d72672a8014393be1da304c613b91a","7ab3f130f8b045bb9f7e81edad567a3a","c8e6a6a4c40548bba5fb806102bbce48","d0a823db47314d78897072b058642c5d","0c3f2158a3784ca69c95d05524a2668e","1b4b16f58b76480a89a35b5b46c67701","066cbe97ab5841109e50683099323364","96c5b4ea8120424a874e0d47e7fa266f","45351f9d32184c4d8409c5d0ede5302d","f938c69168744ccf9fa99b9229d98774","874ed587491441a8b544ad1ecd116a81","f116f78c659c4f158cc3713289e7c137","f7bdc15701fa44488f54e877503ab2b1","506449cfba4e4e1a98463b7c4c3f8be2","abeafb5e0f3e4356a1a8d5ffc47d4d0e","37496a08a74d4c2b8e326672b5c2bbde","fed75d668b5b4000b5e5e650dd9f22bc"]},"id":"FMiyJWAHMa4-","executionInfo":{"status":"ok","timestamp":1684925693335,"user_tz":-120,"elapsed":1708,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"47a74fe7-0706-4550-fa73-866a78d8c5b9"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-5482761042d8e62b/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6696303a99b64b8c996fc9c66fa08554"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"741ec8e2e6174c93919a312a046f285a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"abe3e8a9d55c42aa96d44e445fb560f7"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-5482761042d8e62b/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"066cbe97ab5841109e50683099323364"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 175\n","    })\n","})"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0SxeW28IM7Va","executionInfo":{"status":"ok","timestamp":1684925693335,"user_tz":-120,"elapsed":7,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"e08d64e2-77bb-4cb7-c8eb-90cab6ee57f1"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 53\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 35\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 18\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 18\n","    })\n","})\n"]}]},{"cell_type":"code","source":["dataset['train'][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Z_fyU-Eunev","executionInfo":{"status":"ok","timestamp":1684925693336,"user_tz":-120,"elapsed":6,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"f9fe2d13-4086-4d4a-aa7b-a7da0258ad55"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Subject': 'subject117',\n"," 'Text': 'No creo que se refiera a ESA Biblia .... No pasa nada . Todos tienen derecho a tener amigos imaginarios .. ¿ A las cuantas visitas ? Creo que ya agote mi cupón .. Pues , ví personas hablándole a ventanas .. Catolicismo fue lo que consumieron .. Y el miedo lleva a la ira .. Detrás de la luna .. Shape es \" forma \" en inglés . Y yo soy un poco cambiaformas .. Que estoy cambiando todo el rato de identidad .. ¿ Ya me entendiste ?',\n"," 'label': 0.0}"]},"metadata":{},"execution_count":12}]},{"cell_type":"code","source":["# MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","# MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","# MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base).\n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","# MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-MuWGUZOvBJu","executionInfo":{"status":"ok","timestamp":1684927291231,"user_tz":-120,"elapsed":401,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"63d449f8-7d2d-4d38-a3c4-109d02c00398"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: microsoft/Multilingual-MiniLM-L12-H384\n"]}]},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else:\n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"],"metadata":{"id":"ljpBXXWTvF6b"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Text']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fo_-iSvrvIfk","executionInfo":{"status":"ok","timestamp":1684927295170,"user_tz":-120,"elapsed":588,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"1ff6b59f-838b-42e3-be51-5675cbcb5921"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["count     122.000000\n","mean      211.483607\n","std       172.111161\n","min        65.000000\n","25%       119.000000\n","50%       153.500000\n","75%       246.750000\n","85%       301.150000\n","90%       333.500000\n","95%       505.700000\n","99%       921.550000\n","max      1322.000000\n","dtype: float64"]},"metadata":{},"execution_count":83}]},{"cell_type":"markdown","source":["EJECUTAR HASTA AQUÍ PARA VER LA LEN"],"metadata":{"id":"lOL198jgvERj"}},{"cell_type":"code","source":["MAX_LEN = 512\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Text\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":268,"referenced_widgets":["3addd517b56548bcb83598d5eff87789","529456eee8944a9a8313be4382a2320a","3bb39ae69eb543419ddf7d0bd59514f8","9cbc21741bae43b3b83080bb0c70a260","e6524ad751c244cdaa1b0b372d57cd6c","156fa1a7dbeb43549a6b7ee1b3a5fa87","96631c2d2185400fb3707510a975bd45","72ea940f2c54491d99dd268f9e6acd26","becce6db1eb348ca95ddd8cd7602687f","d6d2387c30c34af1924435db4f277b0f","e10e4ce34ead4a3397e8eef1ed9d85fa"]},"id":"MkV_0THcvUVE","executionInfo":{"status":"ok","timestamp":1684927295685,"user_tz":-120,"elapsed":519,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"50389c86-a463-4db7-a458-f9de3c38f3e6"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/35 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3addd517b56548bcb83598d5eff87789"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":["data_encodings = data_encodings.remove_columns(['Text','Subject'])\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_A3LcmxMwgo4","executionInfo":{"status":"ok","timestamp":1684927295686,"user_tz":-120,"elapsed":4,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"7773cc71-2f9d-4a4f-9a0b-06e202c61377"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":85}]},{"cell_type":"code","source":["from transformers import AutoModelForSequenceClassification\n","# As num_labes is 1, the AutoModelForSequenceClassification will trigger the linear regression and use MSELoss() as the loss function automatically.\n","model = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_labels = 1).to(\"cuda\")"],"metadata":{"id":"o4YciE87wXsR","executionInfo":{"status":"ok","timestamp":1684927300533,"user_tz":-120,"elapsed":4849,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["2400962c2c9842bfb5d793373cb52461","83719696c164420f8cad52641dfe9482","e11528da4c7743bdb9a5708615df1678","b95b5a5620334fc78e43919bc6fbe7dc","2dd51b02e1c14cdd853f637bb9613ee5","19d6503c0172422e879d6a63fc8b6759","ca4b0785f9ed4dc5ac549f460762b7ff","95ff1b0a2c5b4f328047090946715f19","e24d7bddf628452caeb4f52b9fbdf125","4bc43db6bb63429d82b4ed773f680f00","913b59941ac74d63ba3e3c92a043035e","3dc263df64994d758d80eebe2046c50e","61271bdffa2340538b5387932061a8c6","2cfa3134088545e5b5294d0645653890","abffbd97cf504c59abfeee94aa6e3c32","edb3af1ac02b484e8922612f1ae6d1b6","077fc9315ee447a49cb557cd642ee4a4","180806a2add64e82b2674b2eae22ea88","b4b60a5651a043cf9780526a607a8b2d","f0186437ad91448f93fc0f1c4658a9fa","741135d8ca7e4ef985b41f14d7023daf","05fdea21cc0e41ecb6da0b21d0fe0552"]},"outputId":"ff4a72ae-4d8a-46b3-fe82-e1f3cc0dffee"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/430 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2400962c2c9842bfb5d793373cb52461"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/471M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3dc263df64994d758d80eebe2046c50e"}},"metadata":{}}]},{"cell_type":"code","source":["import numpy as np\n","from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","\n","    # loss metrics\n","    mse = mean_squared_error(labels, logits)\n","    rmse = mean_squared_error(labels, logits, squared=False)\n","    mae = mean_absolute_error(labels, logits)\n","    smape = 1/len(labels) * np.sum(2 * np.abs(logits-labels) / (np.abs(labels) + np.abs(logits))*100)\n","    # performance metrics\n","    r2 = r2_score(labels, logits)\n","    # pearson=stats.pearsonr(labels, logits)[0]\n","\n","    # we return a dictionary with all metrics\n","    # return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape, \"pearson\": pearson}\n","    return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape}"],"metadata":{"id":"Kn79dWOFwZxe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import TrainingArguments\n","\n","\n","NUM_EPOCHS = 15 # we recommend at least 3\n","\n","# Specifiy the arguments for the trainer\n","training_args = TrainingArguments(\n","    output_dir ='./results',\n","    num_train_epochs = NUM_EPOCHS,\n","    per_device_train_batch_size = 8, # 128 in the paper\n","    per_device_eval_batch_size = 8,\n","    weight_decay = 0.01,\n","    learning_rate = 2e-5,  # 0.001 in the paper,\n","    logging_dir = './logs',\n","    save_total_limit = 10,\n","    load_best_model_at_end = True,\n","    metric_for_best_model = 'rmse',\n","    evaluation_strategy = \"epoch\",  # steps in the paper\n","    save_strategy = \"epoch\",    # steps in the paper\n","    report_to = 'all',\n",")"],"metadata":{"id":"pL_uOTjYwcSY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import Trainer, EarlyStoppingCallback\n","\n","# Call the Trainer\n","trainer = Trainer(\n","    model = model,\n","    args = training_args,\n","    train_dataset = data_encodings['train'],\n","    eval_dataset = data_encodings['validation'],\n","    compute_metrics = compute_metrics_for_regression,\n","    callbacks=[EarlyStoppingCallback(5, 0.0)]\n",")\n","\n","# Train the model\n","trainer.train()"],"metadata":{"id":"baBlLozYwsH9","executionInfo":{"status":"ok","timestamp":1684927410262,"user_tz":-120,"elapsed":109732,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"9ecead6d-9379-4765-f16b-1871a8171e59"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.21157342195510864, 'eval_mse': 0.21157340705394745, 'eval_rmse': 0.4599711000919342, 'eval_mae': 0.36529117822647095, 'eval_r2': -0.4365000670188115, 'eval_smape': 90.31089952256944, 'eval_runtime': 0.2586, 'eval_samples_per_second': 69.61, 'eval_steps_per_second': 11.602, 'epoch': 1.0}\n","{'eval_loss': 0.14902159571647644, 'eval_mse': 0.14902158081531525, 'eval_rmse': 0.38603314757347107, 'eval_mae': 0.3611944317817688, 'eval_r2': -0.011797857584887605, 'eval_smape': 78.6688503689236, 'eval_runtime': 0.2695, 'eval_samples_per_second': 66.786, 'eval_steps_per_second': 11.131, 'epoch': 2.0}\n","{'eval_loss': 0.14410506188869476, 'eval_mse': 0.14410506188869476, 'eval_rmse': 0.3796117305755615, 'eval_mae': 0.3484991192817688, 'eval_r2': 0.021583343106967412, 'eval_smape': 78.06151665581596, 'eval_runtime': 0.2658, 'eval_samples_per_second': 67.714, 'eval_steps_per_second': 11.286, 'epoch': 3.0}\n","{'eval_loss': 0.14091730117797852, 'eval_mse': 0.14091730117797852, 'eval_rmse': 0.37538954615592957, 'eval_mae': 0.3459985554218292, 'eval_r2': 0.043226969236515256, 'eval_smape': 77.84961615668402, 'eval_runtime': 0.2538, 'eval_samples_per_second': 70.914, 'eval_steps_per_second': 11.819, 'epoch': 4.0}\n","{'eval_loss': 0.13740283250808716, 'eval_mse': 0.13740283250808716, 'eval_rmse': 0.3706788718700409, 'eval_mae': 0.34339237213134766, 'eval_r2': 0.06708895417023408, 'eval_smape': 77.79326036241319, 'eval_runtime': 0.2642, 'eval_samples_per_second': 68.143, 'eval_steps_per_second': 11.357, 'epoch': 5.0}\n","{'eval_loss': 0.13631978631019592, 'eval_mse': 0.13631977140903473, 'eval_rmse': 0.36921507120132446, 'eval_mae': 0.3458632230758667, 'eval_r2': 0.07444238727927144, 'eval_smape': 78.00950792100694, 'eval_runtime': 0.2697, 'eval_samples_per_second': 66.731, 'eval_steps_per_second': 11.122, 'epoch': 6.0}\n","{'train_runtime': 109.696, 'train_samples_per_second': 16.682, 'train_steps_per_second': 2.188, 'train_loss': 0.16082022587458292, 'epoch': 6.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=96, training_loss=0.16082022587458292, metrics={'train_runtime': 109.696, 'train_samples_per_second': 16.682, 'train_steps_per_second': 2.188, 'train_loss': 0.16082022587458292, 'epoch': 6.0})"]},"metadata":{},"execution_count":89}]},{"cell_type":"code","source":["trainer.evaluate()"],"metadata":{"id":"Mf19DwNAwutN","executionInfo":{"status":"ok","timestamp":1684927410263,"user_tz":-120,"elapsed":13,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"bec699ca-6dd8-4507-a667-79f5f6f3610e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.21157342195510864, 'eval_mse': 0.21157340705394745, 'eval_rmse': 0.4599711000919342, 'eval_mae': 0.36529117822647095, 'eval_r2': -0.4365000670188115, 'eval_smape': 90.31089952256944, 'eval_runtime': 0.3063, 'eval_samples_per_second': 58.757, 'eval_steps_per_second': 9.793, 'epoch': 6.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.21157342195510864,\n"," 'eval_mse': 0.21157340705394745,\n"," 'eval_rmse': 0.4599711000919342,\n"," 'eval_mae': 0.36529117822647095,\n"," 'eval_r2': -0.4365000670188115,\n"," 'eval_smape': 90.31089952256944,\n"," 'eval_runtime': 0.3063,\n"," 'eval_samples_per_second': 58.757,\n"," 'eval_steps_per_second': 9.793,\n"," 'epoch': 6.0}"]},"metadata":{},"execution_count":90}]},{"cell_type":"code","source":["trainer.eval_dataset = data_encodings['test']\n","trainer.evaluate()"],"metadata":{"id":"8Nebpu_swxep","executionInfo":{"status":"ok","timestamp":1684927410800,"user_tz":-120,"elapsed":548,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"b76fc28c-afc7-4ffd-ff3c-9d404148b363"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.23008833825588226, 'eval_mse': 0.23008836805820465, 'eval_rmse': 0.4796752631664276, 'eval_mae': 0.41678595542907715, 'eval_r2': -0.7675796783680835, 'eval_smape': 101.8537109375, 'eval_runtime': 0.5008, 'eval_samples_per_second': 69.887, 'eval_steps_per_second': 9.984, 'epoch': 6.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.23008833825588226,\n"," 'eval_mse': 0.23008836805820465,\n"," 'eval_rmse': 0.4796752631664276,\n"," 'eval_mae': 0.41678595542907715,\n"," 'eval_r2': -0.7675796783680835,\n"," 'eval_smape': 101.8537109375,\n"," 'eval_runtime': 0.5008,\n"," 'eval_samples_per_second': 69.887,\n"," 'eval_steps_per_second': 9.984,\n"," 'epoch': 6.0}"]},"metadata":{},"execution_count":91}]},{"cell_type":"code","source":["def get_prediction(text):\n","    # prepare our text into tokenized sequence\n","    inputs = tokenizer(text, max_length=MAX_LEN, padding=\"max_length\", truncation=True, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model(**inputs)   #output is a tensor\n","    return outputs[0].item()    #we only have to return the value of the tensor by using item()"],"metadata":{"id":"SZbzOylrwzH9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred_test=[get_prediction(text) for text in dataset['test']['Text']]\n","# this list will contain the intimacy scoring for all texts in the test dataset\n","#for i in range(len(y_pred_test)):\n","#  print(y_pred_test[i],'\\t',dataset['test']['label'][i],'\\t', abs(float(y_pred_test[i])-float(dataset['test']['label'][i])))"],"metadata":{"id":"f_5Pjn6Yw0mZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred_val=[get_prediction(text) for text in dataset['validation']['Text']]\n","# this list will contain the intimacy scoring for all texts in the test dataset\n","#for i in range(len(y_pred_val)):\n","#  print(y_pred_val[i],'\\t',dataset['validation']['label'][i],'\\t', abs(float(y_pred_val[i])-float(dataset['validation']['label'][i])))"],"metadata":{"id":"IK7O_EizyOiL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","\n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')\n","\n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"],"metadata":{"id":"O77RpRDow2sp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_train = data_encodings['train']['label']\n","y_val = data_encodings['validation']['label']\n","y_test = data_encodings['test']['label']"],"metadata":{"id":"NardrTCEtfO7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print_metrics(y_val, y_pred_val)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vZb8IEGUytld","executionInfo":{"status":"ok","timestamp":1684927412420,"user_tz":-120,"elapsed":6,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"83614a9e-4a6b-43e0-ec48-08b01bacce8e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.21|0.46|0.37|-0.44|90.31|0.35|\n"]}]}]}