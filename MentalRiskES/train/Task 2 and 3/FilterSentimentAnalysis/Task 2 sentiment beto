{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"48670a13a5ab490cb43aa2fdedbb5a1a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_10a6acee78c34a9ab04c474913d4c632","IPY_MODEL_7202e2b1a1fe4690b8ee9a617e0ef2bc","IPY_MODEL_0040412ef9d44f278467236e34d79ac6"],"layout":"IPY_MODEL_e91f9616b41345afa21672e3bc6721af"}},"10a6acee78c34a9ab04c474913d4c632":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e617b7935f4443d1a3694add7902d6ec","placeholder":"​","style":"IPY_MODEL_333888ec53264fe9adfcba0fbfffca36","value":"Downloading data files: 100%"}},"7202e2b1a1fe4690b8ee9a617e0ef2bc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6d7a40c180e74f2db84ea12bb9e2e0bd","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_32221f5e34904d9a852f77eff7e97631","value":1}},"0040412ef9d44f278467236e34d79ac6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f92bc78674d347ee95f87978b3b6ca15","placeholder":"​","style":"IPY_MODEL_c23404ced77346f691cb160e826378e7","value":" 1/1 [00:00&lt;00:00, 38.65it/s]"}},"e91f9616b41345afa21672e3bc6721af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e617b7935f4443d1a3694add7902d6ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"333888ec53264fe9adfcba0fbfffca36":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6d7a40c180e74f2db84ea12bb9e2e0bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"32221f5e34904d9a852f77eff7e97631":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f92bc78674d347ee95f87978b3b6ca15":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c23404ced77346f691cb160e826378e7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cc03f924cc0c43ed80378875b5ff9674":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6374848c5dbe4093b0f9616d37879c16","IPY_MODEL_3fc703fccc744e10bded4713beebf70c","IPY_MODEL_a9bc1cb5c9b946018de464c477c135af"],"layout":"IPY_MODEL_4b5cf52ab2734a3c9e174ce76f667654"}},"6374848c5dbe4093b0f9616d37879c16":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9b89c1a38c8f471abe0f3d43f0837e6e","placeholder":"​","style":"IPY_MODEL_1e9e1e0b05e74aad8e80cde25c077e7a","value":"Extracting data files: 100%"}},"3fc703fccc744e10bded4713beebf70c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_185c810f1e5e4e6babb302bad7163e4b","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2d5b6f53cf584002b84f4ac5a40f8f94","value":1}},"a9bc1cb5c9b946018de464c477c135af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7b504d65a47c4d5083bc6362eba5c4ee","placeholder":"​","style":"IPY_MODEL_be4f4d1e9cda4d64a261d258518ff7e2","value":" 1/1 [00:03&lt;00:00,  3.60s/it]"}},"4b5cf52ab2734a3c9e174ce76f667654":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9b89c1a38c8f471abe0f3d43f0837e6e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1e9e1e0b05e74aad8e80cde25c077e7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"185c810f1e5e4e6babb302bad7163e4b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2d5b6f53cf584002b84f4ac5a40f8f94":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7b504d65a47c4d5083bc6362eba5c4ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"be4f4d1e9cda4d64a261d258518ff7e2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"bc791ac2b037474eb7499300f4191fcd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_490154c9b5b5434dbe8c661e64daac98","IPY_MODEL_ebfc91f5a7214a8ab7803a1b80a042f9","IPY_MODEL_7113615bab9d498f8d98d76c965b8edd"],"layout":"IPY_MODEL_985f39c0d94a43c0ab71c40335865028"}},"490154c9b5b5434dbe8c661e64daac98":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_40d0ecfd1ec544ba8ce0276c720a2b31","placeholder":"​","style":"IPY_MODEL_cc5778707ff142c4aacb8e46d8cebb6a","value":"Generating train split: "}},"ebfc91f5a7214a8ab7803a1b80a042f9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_fd7e49cf0ba8426c9d76cc43a609c562","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_403cb8faaf3f46f08ca7ef212170f2c7","value":1}},"7113615bab9d498f8d98d76c965b8edd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5ed615ee636d4987844f87d736611098","placeholder":"​","style":"IPY_MODEL_9f2c3d6bac0f46119323581471a61abd","value":" 2911/0 [00:00&lt;00:00, 4381.41 examples/s]"}},"985f39c0d94a43c0ab71c40335865028":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"40d0ecfd1ec544ba8ce0276c720a2b31":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc5778707ff142c4aacb8e46d8cebb6a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fd7e49cf0ba8426c9d76cc43a609c562":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"403cb8faaf3f46f08ca7ef212170f2c7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5ed615ee636d4987844f87d736611098":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9f2c3d6bac0f46119323581471a61abd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3219b95a70c34001bd35818e1271d2a2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_be802000b95748a08ae8efd62147c32a","IPY_MODEL_9a72ea65aa2c4f5695f000f55632c5ab","IPY_MODEL_0fdfadf49df147b8b9375fd1bdb1d795"],"layout":"IPY_MODEL_50207cb7c2fb4dee94817a0ba83f48be"}},"be802000b95748a08ae8efd62147c32a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5ce5f0c2245f4169a6f26bf7d558bd90","placeholder":"​","style":"IPY_MODEL_59e4469e503a442282e05ad36a80af3e","value":"100%"}},"9a72ea65aa2c4f5695f000f55632c5ab":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6768eadb9c954d279d62c8972b037f22","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b0163809dfe04577836b6d2fc23b0325","value":1}},"0fdfadf49df147b8b9375fd1bdb1d795":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fe8d679f1ec049dcb8031f460c910c0f","placeholder":"​","style":"IPY_MODEL_b05852fd914444d4b9190f997d610876","value":" 1/1 [00:00&lt;00:00, 21.16it/s]"}},"50207cb7c2fb4dee94817a0ba83f48be":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ce5f0c2245f4169a6f26bf7d558bd90":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"59e4469e503a442282e05ad36a80af3e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6768eadb9c954d279d62c8972b037f22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b0163809dfe04577836b6d2fc23b0325":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"fe8d679f1ec049dcb8031f460c910c0f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b05852fd914444d4b9190f997d610876":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9043a320068b47348c524db41364b0f2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_33558a52a6d447a886d2dcce52873e27","IPY_MODEL_9794e38280714a43b84143ca5dcf0f38","IPY_MODEL_dbc35c10b02b46e3a08bcc2713659a13"],"layout":"IPY_MODEL_571a238de34440b897c25cdd31738cc0"}},"33558a52a6d447a886d2dcce52873e27":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_6f66a93412fe4116b87c47c9323f2a16","placeholder":"​","style":"IPY_MODEL_efa39495348147b188b21625d55a3ab0","value":"Map: 100%"}},"9794e38280714a43b84143ca5dcf0f38":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_ac0e223527d24657bba073e8118a654f","max":585,"min":0,"orientation":"horizontal","style":"IPY_MODEL_266a922d27a04da882d0d963406e3e45","value":585}},"dbc35c10b02b46e3a08bcc2713659a13":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b5d33c3fece44072ab01eba56207f1b7","placeholder":"​","style":"IPY_MODEL_57b42e65e72b49efac46b82043a1b9e4","value":" 585/585 [00:00&lt;00:00, 5475.04 examples/s]"}},"571a238de34440b897c25cdd31738cc0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"6f66a93412fe4116b87c47c9323f2a16":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"efa39495348147b188b21625d55a3ab0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ac0e223527d24657bba073e8118a654f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"266a922d27a04da882d0d963406e3e45":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b5d33c3fece44072ab01eba56207f1b7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"57b42e65e72b49efac46b82043a1b9e4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"_BiM0RepL_H6","executionInfo":{"status":"ok","timestamp":1684930034017,"user_tz":-120,"elapsed":27450,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"fbf2be50-e7b1-4a4f-fc35-e23a185fed81"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["!pip install datasets transformers accelerate"],"metadata":{"id":"wCWqtrBkuBp9","executionInfo":{"status":"ok","timestamp":1684930056958,"user_tz":-120,"elapsed":22946,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"730a916d-790c-4c31-a43b-f96386abafc8"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.12.0-py3-none-any.whl (474 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m474.6/474.6 kB\u001b[0m \u001b[31m30.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting transformers\n","  Downloading transformers-4.29.2-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m114.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.19.0-py3-none-any.whl (219 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m219.1/219.1 kB\u001b[0m \u001b[31m28.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m17.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m29.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m18.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m50.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m28.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Collecting responses<0.19 (from datasets)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m114.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m16.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m35.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m21.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, xxhash, multidict, frozenlist, dill, async-timeout, yarl, responses, multiprocess, huggingface-hub, aiosignal, transformers, aiohttp, datasets, accelerate\n","Successfully installed accelerate-0.19.0 aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.12.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.14.1 multidict-6.0.4 multiprocess-0.70.14 responses-0.18.0 tokenizers-0.13.3 transformers-4.29.2 xxhash-3.2.0 yarl-1.9.2\n"]}]},{"cell_type":"code","source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"],"metadata":{"id":"13dCqvZhuxs_","executionInfo":{"status":"ok","timestamp":1684930056959,"user_tz":-120,"elapsed":12,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"8ddd1864-35de-4308-e5e1-ae1688966345"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Wed May 24 12:07:36 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   50C    P8    10W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"],"metadata":{"id":"4evkaVy1u46V","executionInfo":{"status":"ok","timestamp":1684930058693,"user_tz":-120,"elapsed":1739,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/Sentiment Analysis/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"train_sentiment_no_neutro_beto.csv\")\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":295,"referenced_widgets":["48670a13a5ab490cb43aa2fdedbb5a1a","10a6acee78c34a9ab04c474913d4c632","7202e2b1a1fe4690b8ee9a617e0ef2bc","0040412ef9d44f278467236e34d79ac6","e91f9616b41345afa21672e3bc6721af","e617b7935f4443d1a3694add7902d6ec","333888ec53264fe9adfcba0fbfffca36","6d7a40c180e74f2db84ea12bb9e2e0bd","32221f5e34904d9a852f77eff7e97631","f92bc78674d347ee95f87978b3b6ca15","c23404ced77346f691cb160e826378e7","cc03f924cc0c43ed80378875b5ff9674","6374848c5dbe4093b0f9616d37879c16","3fc703fccc744e10bded4713beebf70c","a9bc1cb5c9b946018de464c477c135af","4b5cf52ab2734a3c9e174ce76f667654","9b89c1a38c8f471abe0f3d43f0837e6e","1e9e1e0b05e74aad8e80cde25c077e7a","185c810f1e5e4e6babb302bad7163e4b","2d5b6f53cf584002b84f4ac5a40f8f94","7b504d65a47c4d5083bc6362eba5c4ee","be4f4d1e9cda4d64a261d258518ff7e2","bc791ac2b037474eb7499300f4191fcd","490154c9b5b5434dbe8c661e64daac98","ebfc91f5a7214a8ab7803a1b80a042f9","7113615bab9d498f8d98d76c965b8edd","985f39c0d94a43c0ab71c40335865028","40d0ecfd1ec544ba8ce0276c720a2b31","cc5778707ff142c4aacb8e46d8cebb6a","fd7e49cf0ba8426c9d76cc43a609c562","403cb8faaf3f46f08ca7ef212170f2c7","5ed615ee636d4987844f87d736611098","9f2c3d6bac0f46119323581471a61abd","3219b95a70c34001bd35818e1271d2a2","be802000b95748a08ae8efd62147c32a","9a72ea65aa2c4f5695f000f55632c5ab","0fdfadf49df147b8b9375fd1bdb1d795","50207cb7c2fb4dee94817a0ba83f48be","5ce5f0c2245f4169a6f26bf7d558bd90","59e4469e503a442282e05ad36a80af3e","6768eadb9c954d279d62c8972b037f22","b0163809dfe04577836b6d2fc23b0325","fe8d679f1ec049dcb8031f460c910c0f","b05852fd914444d4b9190f997d610876"]},"id":"FMiyJWAHMa4-","executionInfo":{"status":"ok","timestamp":1684930067366,"user_tz":-120,"elapsed":8681,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"8ab3dd83-3796-49c0-b839-38b66b425b63"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-dfcc9d56ee28e1e6/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"48670a13a5ab490cb43aa2fdedbb5a1a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"cc03f924cc0c43ed80378875b5ff9674"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"bc791ac2b037474eb7499300f4191fcd"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-dfcc9d56ee28e1e6/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"3219b95a70c34001bd35818e1271d2a2"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2911\n","    })\n","})"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0SxeW28IM7Va","executionInfo":{"status":"ok","timestamp":1684930067367,"user_tz":-120,"elapsed":11,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"748cbec5-884c-4ace-d512-7b202b389c70"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2037\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 874\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 585\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 289\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2037\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 585\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 289\n","    })\n","})\n"]}]},{"cell_type":"code","source":["data_validation = dataset[\"validation\"]"],"metadata":{"id":"qKUgPZR1ojiB","executionInfo":{"status":"ok","timestamp":1684930067367,"user_tz":-120,"elapsed":10,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["dataset['train'][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Z_fyU-Eunev","executionInfo":{"status":"ok","timestamp":1684930067367,"user_tz":-120,"elapsed":9,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"74502f65-0910-49df-badb-5f734ff0e2bb"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Unnamed: 0.1': 0,\n"," 'Unnamed: 0': 5448,\n"," 'Message': 'Pero eso es lo bueno . La literatura que te hace pensar y estar viva y ser lectora activa',\n"," 'Subject': 'subject305',\n"," 'label beto': 'POS',\n"," 'score beto': 0.9987766146659852,\n"," 'label robertuito': 'POS',\n"," 'score robertuito': 0.940822958946228,\n"," 'label': 0.3}"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["# MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","# MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","# MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base). \n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","# MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-MuWGUZOvBJu","executionInfo":{"status":"ok","timestamp":1684938887361,"user_tz":-120,"elapsed":625,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"fcaa2bcb-d45a-43d3-8898-46fa7120681a"},"execution_count":114,"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: distilbert-base-multilingual-cased\n"]}]},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else: \n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"],"metadata":{"id":"ljpBXXWTvF6b","executionInfo":{"status":"ok","timestamp":1684938888921,"user_tz":-120,"elapsed":8,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":115,"outputs":[]},{"cell_type":"code","source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Message']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fo_-iSvrvIfk","executionInfo":{"status":"ok","timestamp":1684938888922,"user_tz":-120,"elapsed":9,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"10a4e328-26a6-425d-ce73-41158e90d1c6"},"execution_count":116,"outputs":[{"output_type":"execute_result","data":{"text/plain":["count    2037.000000\n","mean       23.574374\n","std        50.419809\n","min         5.000000\n","25%        10.000000\n","50%        15.000000\n","75%        25.000000\n","85%        33.000000\n","90%        40.000000\n","95%        58.000000\n","99%       121.640000\n","max      1358.000000\n","dtype: float64"]},"metadata":{},"execution_count":116}]},{"cell_type":"code","source":["MAX_LEN = 50\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Message\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":322,"referenced_widgets":["9043a320068b47348c524db41364b0f2","33558a52a6d447a886d2dcce52873e27","9794e38280714a43b84143ca5dcf0f38","dbc35c10b02b46e3a08bcc2713659a13","571a238de34440b897c25cdd31738cc0","6f66a93412fe4116b87c47c9323f2a16","efa39495348147b188b21625d55a3ab0","ac0e223527d24657bba073e8118a654f","266a922d27a04da882d0d963406e3e45","b5d33c3fece44072ab01eba56207f1b7","57b42e65e72b49efac46b82043a1b9e4"]},"id":"MkV_0THcvUVE","executionInfo":{"status":"ok","timestamp":1684938889359,"user_tz":-120,"elapsed":444,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"d9f040f5-ce61-4f95-aead-0dac0a426c1c"},"execution_count":117,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/585 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"9043a320068b47348c524db41364b0f2"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 2037\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 585\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 289\n","    })\n","})"]},"metadata":{},"execution_count":117}]},{"cell_type":"code","source":["data_encodings = data_encodings.remove_columns(['Unnamed: 0.1','Unnamed: 0','Subject','Message', 'label beto', 'score beto', 'label robertuito', 'score robertuito'])\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_A3LcmxMwgo4","executionInfo":{"status":"ok","timestamp":1684938889360,"user_tz":-120,"elapsed":5,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"070d7434-b570-4726-f449-699bad8a57bc"},"execution_count":118,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 2037\n","    })\n","    test: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 585\n","    })\n","    validation: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 289\n","    })\n","})"]},"metadata":{},"execution_count":118}]},{"cell_type":"code","source":["from transformers import AutoModelForSequenceClassification\n","# As num_labes is 1, the AutoModelForSequenceClassification will trigger the linear regression and use MSELoss() as the loss function automatically.\n","model = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_labels = 1).to(\"cuda\")"],"metadata":{"id":"o4YciE87wXsR","executionInfo":{"status":"ok","timestamp":1684938895379,"user_tz":-120,"elapsed":6022,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":119,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","\n","    # loss metrics\n","    mse = mean_squared_error(labels, logits)\n","    rmse = mean_squared_error(labels, logits, squared=False)\n","    mae = mean_absolute_error(labels, logits)\n","    smape = 1/len(labels) * np.sum(2 * np.abs(logits-labels) / (np.abs(labels) + np.abs(logits))*100)\n","    # performance metrics\n","    r2 = r2_score(labels, logits)\n","    # pearson=stats.pearsonr(labels, logits)[0]\n","\n","    # we return a dictionary with all metrics\n","    # return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape, \"pearson\": pearson}\n","    return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape}"],"metadata":{"id":"Kn79dWOFwZxe","executionInfo":{"status":"ok","timestamp":1684938895380,"user_tz":-120,"elapsed":6,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":120,"outputs":[]},{"cell_type":"code","source":["from transformers import TrainingArguments\n","\n","\n","NUM_EPOCHS = 15 # we recommend at least 3\n","\n","# Specifiy the arguments for the trainer  \n","training_args = TrainingArguments(\n","    output_dir ='./results',          \n","    num_train_epochs = NUM_EPOCHS,     \n","    per_device_train_batch_size = 8, # 128 in the paper   \n","    per_device_eval_batch_size = 8,   \n","    weight_decay = 0.01,               \n","    learning_rate = 2e-5,  # 0.001 in the paper,\n","    logging_dir = './logs',            \n","    save_total_limit = 10,\n","    load_best_model_at_end = True,     \n","    metric_for_best_model = 'rmse',    \n","    evaluation_strategy = \"epoch\",  # steps in the paper\n","    save_strategy = \"epoch\",    # steps in the paper\n","    report_to = 'all',\n",") "],"metadata":{"id":"pL_uOTjYwcSY","executionInfo":{"status":"ok","timestamp":1684938895380,"user_tz":-120,"elapsed":5,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":121,"outputs":[]},{"cell_type":"code","source":["from transformers import Trainer, EarlyStoppingCallback\n","\n","# Call the Trainer\n","trainer = Trainer(\n","    model = model,                         \n","    args = training_args,                  \n","    train_dataset = data_encodings['train'],         \n","    eval_dataset = data_encodings['validation'],          \n","    compute_metrics = compute_metrics_for_regression,    \n","    callbacks=[EarlyStoppingCallback(5, 0.0)] \n",")\n","\n","# Train the model\n","trainer.train()"],"metadata":{"id":"baBlLozYwsH9","executionInfo":{"status":"ok","timestamp":1684939266781,"user_tz":-120,"elapsed":371406,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"ccc9c8d0-3f5f-4903-c2d9-18d7760ed010"},"execution_count":122,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.10408025234937668, 'eval_mse': 0.10408025979995728, 'eval_rmse': 0.32261472940444946, 'eval_mae': 0.28580644726753235, 'eval_r2': 0.1191867059391507, 'eval_smape': 62.35217073961938, 'eval_runtime': 0.9608, 'eval_samples_per_second': 300.797, 'eval_steps_per_second': 38.51, 'epoch': 1.0}\n","{'loss': 0.1129, 'learning_rate': 1.738562091503268e-05, 'epoch': 1.96}\n","{'eval_loss': 0.11365266144275665, 'eval_mse': 0.11365264654159546, 'eval_rmse': 0.3371240794658661, 'eval_mae': 0.2764829695224762, 'eval_r2': 0.03817713632612185, 'eval_smape': 61.57113700259516, 'eval_runtime': 0.5791, 'eval_samples_per_second': 499.06, 'eval_steps_per_second': 63.893, 'epoch': 2.0}\n","{'eval_loss': 0.10981470346450806, 'eval_mse': 0.10981470346450806, 'eval_rmse': 0.33138301968574524, 'eval_mae': 0.271749347448349, 'eval_r2': 0.0706570583402707, 'eval_smape': 63.49341749567474, 'eval_runtime': 0.5787, 'eval_samples_per_second': 499.394, 'eval_steps_per_second': 63.936, 'epoch': 3.0}\n","{'loss': 0.0519, 'learning_rate': 1.4771241830065362e-05, 'epoch': 3.92}\n","{'eval_loss': 0.1252754032611847, 'eval_mse': 0.1252754032611847, 'eval_rmse': 0.3539426624774933, 'eval_mae': 0.28234899044036865, 'eval_r2': -0.0601840740250037, 'eval_smape': 62.034588559688586, 'eval_runtime': 0.5732, 'eval_samples_per_second': 504.177, 'eval_steps_per_second': 64.549, 'epoch': 4.0}\n","{'eval_loss': 0.11467642337083817, 'eval_mse': 0.11467643827199936, 'eval_rmse': 0.33863911032676697, 'eval_mae': 0.2770499885082245, 'eval_r2': 0.02951306492825967, 'eval_smape': 64.28969777249135, 'eval_runtime': 0.5756, 'eval_samples_per_second': 502.108, 'eval_steps_per_second': 64.284, 'epoch': 5.0}\n","{'loss': 0.0186, 'learning_rate': 1.215686274509804e-05, 'epoch': 5.88}\n","{'eval_loss': 0.12604990601539612, 'eval_mse': 0.12604990601539612, 'eval_rmse': 0.35503506660461426, 'eval_mae': 0.2847471535205841, 'eval_r2': -0.0667384901120629, 'eval_smape': 64.08883001730104, 'eval_runtime': 0.5848, 'eval_samples_per_second': 494.213, 'eval_steps_per_second': 63.273, 'epoch': 6.0}\n","{'eval_loss': 0.11800254881381989, 'eval_mse': 0.11800254136323929, 'eval_rmse': 0.34351497888565063, 'eval_mae': 0.2784287929534912, 'eval_r2': 0.0013647867379811274, 'eval_smape': 63.53753514273357, 'eval_runtime': 0.5777, 'eval_samples_per_second': 500.238, 'eval_steps_per_second': 64.044, 'epoch': 7.0}\n","{'loss': 0.0105, 'learning_rate': 9.54248366013072e-06, 'epoch': 7.84}\n","{'eval_loss': 0.12225507944822311, 'eval_mse': 0.12225507944822311, 'eval_rmse': 0.34964993596076965, 'eval_mae': 0.27845892310142517, 'eval_r2': -0.034623642451862446, 'eval_smape': 62.21663467776817, 'eval_runtime': 0.5796, 'eval_samples_per_second': 498.635, 'eval_steps_per_second': 63.839, 'epoch': 8.0}\n","{'eval_loss': 0.11985532939434052, 'eval_mse': 0.11985532194375992, 'eval_rmse': 0.3462012708187103, 'eval_mae': 0.2783645689487457, 'eval_r2': -0.0143149736581909, 'eval_smape': 62.32150194636679, 'eval_runtime': 0.5855, 'eval_samples_per_second': 493.553, 'eval_steps_per_second': 63.188, 'epoch': 9.0}\n","{'loss': 0.008, 'learning_rate': 6.928104575163399e-06, 'epoch': 9.8}\n","{'eval_loss': 0.12116893380880356, 'eval_mse': 0.12116891890764236, 'eval_rmse': 0.34809327125549316, 'eval_mae': 0.2821272909641266, 'eval_r2': -0.025431742550865, 'eval_smape': 62.05020680147059, 'eval_runtime': 0.5653, 'eval_samples_per_second': 511.221, 'eval_steps_per_second': 65.45, 'epoch': 10.0}\n","{'eval_loss': 0.11783238500356674, 'eval_mse': 0.11783238500356674, 'eval_rmse': 0.3432672321796417, 'eval_mae': 0.2772858440876007, 'eval_r2': 0.002804839807356241, 'eval_smape': 61.885252216695505, 'eval_runtime': 0.57, 'eval_samples_per_second': 507.021, 'eval_steps_per_second': 64.913, 'epoch': 11.0}\n","{'train_runtime': 371.3291, 'train_samples_per_second': 82.285, 'train_steps_per_second': 10.301, 'train_loss': 0.03665660094874853, 'epoch': 11.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2805, training_loss=0.03665660094874853, metrics={'train_runtime': 371.3291, 'train_samples_per_second': 82.285, 'train_steps_per_second': 10.301, 'train_loss': 0.03665660094874853, 'epoch': 11.0})"]},"metadata":{},"execution_count":122}]},{"cell_type":"code","source":["trainer.evaluate()"],"metadata":{"id":"Mf19DwNAwutN","executionInfo":{"status":"ok","timestamp":1684939267350,"user_tz":-120,"elapsed":580,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"fc94dbcc-af4e-4c08-cc7a-c6f8045d0848"},"execution_count":123,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.12604990601539612, 'eval_mse': 0.12604990601539612, 'eval_rmse': 0.35503506660461426, 'eval_mae': 0.2847471535205841, 'eval_r2': -0.0667384901120629, 'eval_smape': 64.08883001730104, 'eval_runtime': 0.5724, 'eval_samples_per_second': 504.859, 'eval_steps_per_second': 64.636, 'epoch': 11.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.12604990601539612,\n"," 'eval_mse': 0.12604990601539612,\n"," 'eval_rmse': 0.35503506660461426,\n"," 'eval_mae': 0.2847471535205841,\n"," 'eval_r2': -0.0667384901120629,\n"," 'eval_smape': 64.08883001730104,\n"," 'eval_runtime': 0.5724,\n"," 'eval_samples_per_second': 504.859,\n"," 'eval_steps_per_second': 64.636,\n"," 'epoch': 11.0}"]},"metadata":{},"execution_count":123}]},{"cell_type":"code","source":["trainer.eval_dataset = data_encodings['test']\n","trainer.evaluate()"],"metadata":{"id":"8Nebpu_swxep","executionInfo":{"status":"ok","timestamp":1684939269001,"user_tz":-120,"elapsed":1653,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"d4cc99e9-63fe-4399-df1d-2378a5397fa4"},"execution_count":124,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.1396608203649521, 'eval_mse': 0.1396608203649521, 'eval_rmse': 0.3737122118473053, 'eval_mae': 0.2978004217147827, 'eval_r2': -0.129540022502171, 'eval_smape': 69.86539797008547, 'eval_runtime': 1.0431, 'eval_samples_per_second': 560.835, 'eval_steps_per_second': 70.943, 'epoch': 11.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.1396608203649521,\n"," 'eval_mse': 0.1396608203649521,\n"," 'eval_rmse': 0.3737122118473053,\n"," 'eval_mae': 0.2978004217147827,\n"," 'eval_r2': -0.129540022502171,\n"," 'eval_smape': 69.86539797008547,\n"," 'eval_runtime': 1.0431,\n"," 'eval_samples_per_second': 560.835,\n"," 'eval_steps_per_second': 70.943,\n"," 'epoch': 11.0}"]},"metadata":{},"execution_count":124}]},{"cell_type":"code","source":["def get_prediction(text):\n","    # prepare our text into tokenized sequence\n","    inputs = tokenizer(text, max_length=MAX_LEN, padding=\"max_length\", truncation=True, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model(**inputs)   #output is a tensor\n","    return outputs[0].item()    #we only have to return the value of the tensor by using item()"],"metadata":{"id":"SZbzOylrwzH9","executionInfo":{"status":"ok","timestamp":1684939269001,"user_tz":-120,"elapsed":4,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":125,"outputs":[]},{"cell_type":"code","source":["y_pred=[get_prediction(text) for text in dataset['validation']['Message']]"],"metadata":{"id":"f_5Pjn6Yw0mZ","executionInfo":{"status":"ok","timestamp":1684939270599,"user_tz":-120,"elapsed":1602,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":126,"outputs":[]},{"cell_type":"code","source":["# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","    \n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')      \n","    \n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"],"metadata":{"id":"O77RpRDow2sp","executionInfo":{"status":"ok","timestamp":1684939270600,"user_tz":-120,"elapsed":6,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":127,"outputs":[]},{"cell_type":"code","source":["y_train = data_encodings['train']['label']\n","y_val = data_encodings['validation']['label']\n","y_test = data_encodings['test']['label']"],"metadata":{"id":"FkdfE-qW7y_9","executionInfo":{"status":"ok","timestamp":1684939270601,"user_tz":-120,"elapsed":7,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":128,"outputs":[]},{"cell_type":"code","source":["#print_metrics(y_test, y_pred)\n","print_metrics(y_val, y_pred)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"yuJIBWvo7ddz","executionInfo":{"status":"ok","timestamp":1684939270601,"user_tz":-120,"elapsed":7,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"b74a9400-5ce6-48c1-bc33-d9e476a0476e"},"execution_count":129,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.13|0.36|0.28|-0.07|64.09|0.35|\n"]}]},{"cell_type":"code","source":["with open(\"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/task2_gold_b.txt\") as file:\n","  final_labels_list = file.readlines()\n","final_labels_list\n","\n","final_labels = {}\n","\n","for label in final_labels_list:\n","  if label == final_labels_list[0]:\n","    continue\n","\n","  key = \"\"\n","  value = \"\"\n","\n","  comma = False\n","  for letter in label:\n","    if letter == '\\n':\n","      continue\n","    if letter == ',':\n","      comma = True\n","      continue\n","    if not comma:\n","      key += letter\n","    else:\n","      value += letter\n","  \n","  final_labels[key] = float(value)\n"],"metadata":{"id":"iKs5yju97KRp","executionInfo":{"status":"ok","timestamp":1684939270602,"user_tz":-120,"elapsed":7,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":130,"outputs":[]},{"cell_type":"code","source":["predicted_labels = {}\n","for subject in final_labels:\n","  predicted_labels[subject] = 0\n","for index,text in enumerate(data_validation['Message']):\n","  pred = get_prediction(text)\n","  if pred > predicted_labels[data_validation[index]['Subject']]:\n","    predicted_labels[data_validation[index]['Subject']] = pred"],"metadata":{"id":"G_i-aKG96jfm","executionInfo":{"status":"ok","timestamp":1684939273394,"user_tz":-120,"elapsed":2798,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":131,"outputs":[]},{"cell_type":"code","source":["x = list(final_labels.values())\n","y = list(predicted_labels.values())"],"metadata":{"id":"5yMHodHnXOq8","executionInfo":{"status":"ok","timestamp":1684939273394,"user_tz":-120,"elapsed":13,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":132,"outputs":[]},{"cell_type":"code","source":["for i in range(len(x)):\n","  if (x[i] == y[i]):\n","    y[i] += 0.001"],"metadata":{"id":"IJpHzQr4Un7f","executionInfo":{"status":"ok","timestamp":1684939273395,"user_tz":-120,"elapsed":14,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}}},"execution_count":133,"outputs":[]},{"cell_type":"code","source":["print_metrics(x,y)"],"metadata":{"id":"NlXlXL1ksaNY","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684939273395,"user_tz":-120,"elapsed":13,"user":{"displayName":"uedng f nkednf","userId":"14745821952800097975"}},"outputId":"9ee38d4b-7218-4284-da3c-d07a704b52bf"},"execution_count":134,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.23|0.48|0.37|-0.71|106.85|0.22|\n"]}]}]}