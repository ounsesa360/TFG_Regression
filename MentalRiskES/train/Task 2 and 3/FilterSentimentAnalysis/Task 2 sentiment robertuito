{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":26468,"status":"ok","timestamp":1684930031991,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"_BiM0RepL_H6","outputId":"aaac38d1-ebd8-4cc7-89a1-fd34f93968bf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16865,"status":"ok","timestamp":1684930048851,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"wCWqtrBkuBp9","outputId":"f337d245-7f47-4367-c24b-de4422a8b773"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.12.0-py3-none-any.whl (474 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m474.6/474.6 kB\u001b[0m \u001b[31m10.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting transformers\n","  Downloading transformers-4.29.2-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m79.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.19.0-py3-none-any.whl (219 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m219.1/219.1 kB\u001b[0m \u001b[31m28.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m14.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m25.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m17.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m63.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m26.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Collecting responses<0.19 (from datasets)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m103.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m6.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m30.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m21.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, xxhash, multidict, frozenlist, dill, async-timeout, yarl, responses, multiprocess, huggingface-hub, aiosignal, transformers, aiohttp, datasets, accelerate\n","Successfully installed accelerate-0.19.0 aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.12.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.14.1 multidict-6.0.4 multiprocess-0.70.14 responses-0.18.0 tokenizers-0.13.3 transformers-4.29.2 xxhash-3.2.0 yarl-1.9.2\n"]}],"source":["!pip install datasets transformers accelerate"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1151,"status":"ok","timestamp":1684930050000,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"13dCqvZhuxs_","outputId":"319e5f52-d0f3-4810-8757-a19df9c8ad85"},"outputs":[{"output_type":"stream","name":"stdout","text":["Wed May 24 12:07:28 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   35C    P8     9W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":1030,"status":"ok","timestamp":1684930051028,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"4evkaVy1u46V"},"outputs":[],"source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":295,"referenced_widgets":["ee6bb0ab85384701a158a9868a673dea","d6689ec7f5544fe6b9f2b2e430b9be01","363be68ae4fa4c15990d8a1a819785c8","b7d915adfc954ac597488400062ec89f","a2593bc6c7b74d0f870968322c802246","4c907b4bb4dc4da0a90445677e3ea498","89e54d81a6a749a98326e3f831789fe0","b32255a86e764bbc93f6a947ade769e2","976855958d5f45988a8d7c3781b071e9","78dcf66d1291441bb5117965802a746c","2edea6c2f06b4d93ac6e4d27805c9654","420183fbcdee4068b4db6b69a37d650c","3d26fcecb38c46b0b655635e0b0e83ee","035a6fe9a501481aaf168c29587ab5a9","09d6561313d246928696d5cc60de3faa","79a830b33ab646d99080fcb52ad0e534","b608d03d860e4ac39cd364a608fc49ec","2a9144cdfbab41b790409a0010695448","6759c3d5643f4600b5f99de230c4fa2d","11b5dc301c3c466c8fae2084edb74e3b","bccccd77e3de44248e8eca195d7671eb","fcf5a277711d45129834382ca75fff7a","867f2bd73a0e4a1bb2869d00d0b7acca","a795d6c1be0048e495836466c5bd7e75","643747b617d0408bbbb4d1fd7b5cb734","6a0bcde364e34e569a9c6c2bc541157a","2b2c095e5f1e424fac20d17d481c485a","ec33c48345b84762a8ca17ae0f2a0c5a","46cce8f77c4d4e02a0e7a66faf914eb8","cb786c4ac524462491a2fe1dc11b7a8b","b3ff0b3926b1419a9d57232b45b5dd9a","7e37d179afcb42f0b4252757a563272a","6a301a7a395445ca8366afb936a87320","4e64ac11ddf544c2b5ace3ede8b707d9","6a61bba7d6bc419b957509e49b342561","fe0fd0b0b166482591a0f358e7e544fe","b95074a7584b4278a3360433ea3bc538","89d0362076864014b35fe003b5c8e90c","f8b28131ed6249b6a9d4225e50b397e4","9ab7d104d95449b28918b21aa78b6179","ae90872ceb474ec28a09db2b4425ff1a","586149aa26db4e95a3cddb851c57ce19","0b5610a847fe402dafb83a76dc94d3d2","0d6e7fd0e3424681924f82107faeaa34"]},"executionInfo":{"elapsed":3408,"status":"ok","timestamp":1684930054428,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"FMiyJWAHMa4-","outputId":"7ba14f1c-fe95-49b4-ec57-5e2639a17e41"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-005b400bf68e2466/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ee6bb0ab85384701a158a9868a673dea"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"420183fbcdee4068b4db6b69a37d650c"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"867f2bd73a0e4a1bb2869d00d0b7acca"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-005b400bf68e2466/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"4e64ac11ddf544c2b5ace3ede8b707d9"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 3318\n","    })\n","})"]},"metadata":{},"execution_count":5}],"source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/Sentiment Analysis/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"train_sentiment_no_neutro_robertuito.csv\")\n","dataset"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":16,"status":"ok","timestamp":1684930054428,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"0SxeW28IM7Va","outputId":"77b0dcc8-8c37-4fc7-ad11-9fc9649cbd45"},"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2322\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 996\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 667\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 329\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2322\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 667\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 329\n","    })\n","})\n"]}],"source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"]},{"cell_type":"code","source":["data_validation = dataset[\"validation\"]"],"metadata":{"id":"2k5ab-5CG3al","executionInfo":{"status":"ok","timestamp":1684930054429,"user_tz":-120,"elapsed":16,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15,"status":"ok","timestamp":1684930054429,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"2Z_fyU-Eunev","outputId":"f951aa37-b1cf-4d37-8835-8a46af8327ee"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Unnamed: 0.1': 0,\n"," 'Unnamed: 0': 4690,\n"," 'Message': 'Fatal , pero no creo q seas eso . Nadie sabe cómo somos exactamente . Me pasa un poco con mi padre tb . No sabe muy bien quién soy . Duele .',\n"," 'Subject': 'subject269',\n"," 'label beto': 'NEG',\n"," 'score beto': 0.9981232285499572,\n"," 'label robertuito': 'NEG',\n"," 'score robertuito': 0.5761216878890991,\n"," 'label': 1.0}"]},"metadata":{},"execution_count":8}],"source":["dataset['train'][0]"]},{"cell_type":"code","execution_count":93,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":807,"status":"ok","timestamp":1684936259603,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"-MuWGUZOvBJu","outputId":"6bbc4315-723f-45ba-c945-dceddfc43392"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: microsoft/Multilingual-MiniLM-L12-H384\n"]}],"source":["# MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","# MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","# MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base). \n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","# MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"]},{"cell_type":"code","execution_count":94,"metadata":{"executionInfo":{"elapsed":1628,"status":"ok","timestamp":1684936261657,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"ljpBXXWTvF6b"},"outputs":[],"source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else: \n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"]},{"cell_type":"code","execution_count":95,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":424,"status":"ok","timestamp":1684936262080,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"Fo_-iSvrvIfk","outputId":"7bde456c-34b1-4a47-d431-717e2daa78fa"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["count    2322.000000\n","mean       20.812231\n","std        32.084282\n","min         6.000000\n","25%        10.000000\n","50%        14.000000\n","75%        23.000000\n","85%        31.000000\n","90%        38.900000\n","95%        51.950000\n","99%       111.790000\n","max      1259.000000\n","dtype: float64"]},"metadata":{},"execution_count":95}],"source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Message']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"]},{"cell_type":"code","execution_count":96,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":322,"referenced_widgets":["b96e3c05c6ba429ca052ccd964213a84","9b52bf78684b4ad9916995451f9cc754","36835cdab35c4bccbc4eae75c6991652","4d85ac9607b841bc932719fe0f731771","c3f2727e8e544ae5bba04013a843f849","3f0386f35bbc406b82fa4a6c8e47c793","0a9fa5372a024c3495abfe1c0efb3e6e","36cbf8b961d84a9aa34c651725b6fe81","280862f79a6a403fa765d8f6e11345c3","983e71afa6684a17a87c5d0513f220c0","7e2c5768118f4eca9759f86f3e2cab54"]},"executionInfo":{"elapsed":13,"status":"ok","timestamp":1684936262080,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"MkV_0THcvUVE","outputId":"80f3dd3a-b535-4c40-ba6c-25ad1aafb537"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/667 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b96e3c05c6ba429ca052ccd964213a84"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 2322\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 667\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 329\n","    })\n","})"]},"metadata":{},"execution_count":96}],"source":["MAX_LEN = 128\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Message\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings"]},{"cell_type":"code","execution_count":97,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":12,"status":"ok","timestamp":1684936262081,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"_A3LcmxMwgo4","outputId":"ce7973dc-9f5f-4e1b-eb68-fb97fbde356e"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 2322\n","    })\n","    test: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 667\n","    })\n","    validation: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 329\n","    })\n","})"]},"metadata":{},"execution_count":97}],"source":["data_encodings = data_encodings.remove_columns(['Unnamed: 0.1','Unnamed: 0','Subject','Message', 'label beto', 'score beto', 'label robertuito', 'score robertuito'])\n","data_encodings"]},{"cell_type":"code","execution_count":98,"metadata":{"executionInfo":{"elapsed":8335,"status":"ok","timestamp":1684936270406,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"o4YciE87wXsR","colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["fef044e3e9354c0784245a4d24e0ee17","10d3f32e91b3465c8f40bc6956ada037","4e66142ae3764fbe94ab2ccee99dbf5b","9a88245df430417a86d23d83012a7d1a","f3dfc374a471491e9fa55380c5ef8b70","e0a04dd05f8c43a0886af820054fdacb","61a9e072cd37468b89734d2aca9e579b","315aaf810e0441baa873519cabb51b5a","0a250257c924476b8f970479e606bc9f","d3521614a5ab4265946d481266fb0f38","6f35f08ed9b249d887b34c822c3f2a8c","06d8bd1092af4887ae89fcda75440020","4ea09d1fea8e418fb77ba77b6b940987","855aa51fee4a41a3bd9eb51a210e7260","6667e626defb409ca0fb16212c17ec27","b07e8b72d40d4e3a8a3561acffc7e415","f6fef111c13143e698ecd42438401ed1","a914281aaff14739ad632bf7a1cb0f93","7868530dec23498abf16a3d8938ed0e6","cb4e14129cdb40bd9e791437a4214c34","f86d23bced8c484b9076be616fbb3788","995d84ae467640a4848fe3bbdcb067da"]},"outputId":"f6c48a97-b78d-4799-a9d5-18ef63d2c6b9"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/430 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"fef044e3e9354c0784245a4d24e0ee17"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/471M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"06d8bd1092af4887ae89fcda75440020"}},"metadata":{}}],"source":["from transformers import AutoModelForSequenceClassification\n","# As num_labes is 1, the AutoModelForSequenceClassification will trigger the linear regression and use MSELoss() as the loss function automatically.\n","model = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_labels = 1).to(\"cuda\")"]},{"cell_type":"code","execution_count":99,"metadata":{"executionInfo":{"elapsed":11,"status":"ok","timestamp":1684936270406,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"Kn79dWOFwZxe"},"outputs":[],"source":["import numpy as np\n","from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","\n","    # loss metrics\n","    mse = mean_squared_error(labels, logits)\n","    rmse = mean_squared_error(labels, logits, squared=False)\n","    mae = mean_absolute_error(labels, logits)\n","    smape = 1/len(labels) * np.sum(2 * np.abs(logits-labels) / (np.abs(labels) + np.abs(logits))*100)\n","    # performance metrics\n","    r2 = r2_score(labels, logits)\n","    # pearson=stats.pearsonr(labels, logits)[0]\n","\n","    # we return a dictionary with all metrics\n","    # return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape, \"pearson\": pearson}\n","    return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape}"]},{"cell_type":"code","execution_count":100,"metadata":{"executionInfo":{"elapsed":12,"status":"ok","timestamp":1684936270407,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"},"user_tz":-120},"id":"pL_uOTjYwcSY"},"outputs":[],"source":["from transformers import TrainingArguments\n","\n","\n","NUM_EPOCHS = 15 # we recommend at least 3\n","\n","# Specifiy the arguments for the trainer  \n","training_args = TrainingArguments(\n","    output_dir ='./results',          \n","    num_train_epochs = NUM_EPOCHS,     \n","    per_device_train_batch_size = 8, # 128 in the paper   \n","    per_device_eval_batch_size = 8,   \n","    weight_decay = 0.01,               \n","    learning_rate = 2e-5,  # 0.001 in the paper,\n","    logging_dir = './logs',            \n","    save_total_limit = 10,\n","    load_best_model_at_end = True,     \n","    metric_for_best_model = 'rmse',    \n","    evaluation_strategy = \"epoch\",  # steps in the paper\n","    save_strategy = \"epoch\",    # steps in the paper\n","    report_to = 'all',\n",") "]},{"cell_type":"code","execution_count":101,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"baBlLozYwsH9","outputId":"755ada78-93bf-4aa5-fa9a-794b6c7ba6b5","executionInfo":{"status":"ok","timestamp":1684936915255,"user_tz":-120,"elapsed":644860,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.11621854454278946, 'eval_mse': 0.11621854454278946, 'eval_rmse': 0.340908408164978, 'eval_mae': 0.30655786395072937, 'eval_r2': 0.04223787653728972, 'eval_smape': 67.1580547112462, 'eval_runtime': 0.8244, 'eval_samples_per_second': 399.059, 'eval_steps_per_second': 50.944, 'epoch': 1.0}\n","{'loss': 0.1295, 'learning_rate': 1.770904925544101e-05, 'epoch': 1.72}\n","{'eval_loss': 0.11194571107625961, 'eval_mse': 0.11194571107625961, 'eval_rmse': 0.3345828950405121, 'eval_mae': 0.29359838366508484, 'eval_r2': 0.07745045091897385, 'eval_smape': 65.26260923252279, 'eval_runtime': 0.9578, 'eval_samples_per_second': 343.511, 'eval_steps_per_second': 43.853, 'epoch': 2.0}\n","{'eval_loss': 0.1264735609292984, 'eval_mse': 0.1264735758304596, 'eval_rmse': 0.3556312322616577, 'eval_mae': 0.2944221496582031, 'eval_r2': -0.04227426734735795, 'eval_smape': 63.39261374430091, 'eval_runtime': 0.8355, 'eval_samples_per_second': 393.755, 'eval_steps_per_second': 50.267, 'epoch': 3.0}\n","{'loss': 0.0989, 'learning_rate': 1.541809851088202e-05, 'epoch': 3.44}\n","{'eval_loss': 0.12106383591890335, 'eval_mse': 0.12106383591890335, 'eval_rmse': 0.3479422926902771, 'eval_mae': 0.285627543926239, 'eval_r2': 0.002307534594454874, 'eval_smape': 65.09139912613982, 'eval_runtime': 0.8098, 'eval_samples_per_second': 406.272, 'eval_steps_per_second': 51.864, 'epoch': 4.0}\n","{'eval_loss': 0.12057817727327347, 'eval_mse': 0.12057817727327347, 'eval_rmse': 0.34724369645118713, 'eval_mae': 0.28571105003356934, 'eval_r2': 0.006309987089483826, 'eval_smape': 63.18319600113982, 'eval_runtime': 0.8549, 'eval_samples_per_second': 384.859, 'eval_steps_per_second': 49.131, 'epoch': 5.0}\n","{'loss': 0.0746, 'learning_rate': 1.3127147766323025e-05, 'epoch': 5.15}\n","{'eval_loss': 0.1258779764175415, 'eval_mse': 0.1258779764175415, 'eval_rmse': 0.35479286313056946, 'eval_mae': 0.28370732069015503, 'eval_r2': -0.03736591349313567, 'eval_smape': 65.68790962196049, 'eval_runtime': 0.7943, 'eval_samples_per_second': 414.219, 'eval_steps_per_second': 52.879, 'epoch': 6.0}\n","{'loss': 0.0562, 'learning_rate': 1.0836197021764032e-05, 'epoch': 6.87}\n","{'eval_loss': 0.14358824491500854, 'eval_mse': 0.14358824491500854, 'eval_rmse': 0.37893038988113403, 'eval_mae': 0.29709547758102417, 'eval_r2': -0.18331704050998598, 'eval_smape': 64.72775574658054, 'eval_runtime': 0.7976, 'eval_samples_per_second': 412.509, 'eval_steps_per_second': 52.661, 'epoch': 7.0}\n","{'eval_loss': 0.13870665431022644, 'eval_mse': 0.13870665431022644, 'eval_rmse': 0.3724334239959717, 'eval_mae': 0.2902478277683258, 'eval_r2': -0.14308762403622066, 'eval_smape': 65.45388487841946, 'eval_runtime': 0.7916, 'eval_samples_per_second': 415.636, 'eval_steps_per_second': 53.06, 'epoch': 8.0}\n","{'loss': 0.0421, 'learning_rate': 8.54524627720504e-06, 'epoch': 8.59}\n","{'eval_loss': 0.1430944949388504, 'eval_mse': 0.1430944949388504, 'eval_rmse': 0.37827834486961365, 'eval_mae': 0.29621192812919617, 'eval_r2': -0.17924799372433875, 'eval_smape': 64.64867496200608, 'eval_runtime': 0.7886, 'eval_samples_per_second': 417.21, 'eval_steps_per_second': 53.261, 'epoch': 9.0}\n","{'eval_loss': 0.14250779151916504, 'eval_mse': 0.14250780642032623, 'eval_rmse': 0.37750205397605896, 'eval_mae': 0.2931143343448639, 'eval_r2': -0.17441304921736078, 'eval_smape': 64.39890055091185, 'eval_runtime': 0.7923, 'eval_samples_per_second': 415.242, 'eval_steps_per_second': 53.01, 'epoch': 10.0}\n","{'loss': 0.0329, 'learning_rate': 6.254295532646049e-06, 'epoch': 10.31}\n","{'eval_loss': 0.14183790981769562, 'eval_mse': 0.14183789491653442, 'eval_rmse': 0.37661370635032654, 'eval_mae': 0.29080531001091003, 'eval_r2': -0.16889237909312516, 'eval_smape': 66.31343797492401, 'eval_runtime': 0.8693, 'eval_samples_per_second': 378.466, 'eval_steps_per_second': 48.315, 'epoch': 11.0}\n","{'eval_loss': 0.14388880133628845, 'eval_mse': 0.14388878643512726, 'eval_rmse': 0.3793267607688904, 'eval_mae': 0.29592636227607727, 'eval_r2': -0.18579388223445759, 'eval_smape': 64.12042885638297, 'eval_runtime': 0.8018, 'eval_samples_per_second': 410.318, 'eval_steps_per_second': 52.381, 'epoch': 12.0}\n","{'loss': 0.0275, 'learning_rate': 3.9633447880870564e-06, 'epoch': 12.03}\n","{'eval_loss': 0.140252023935318, 'eval_mse': 0.140252023935318, 'eval_rmse': 0.37450236082077026, 'eval_mae': 0.2911853790283203, 'eval_r2': -0.15582309117704218, 'eval_smape': 64.75524791033435, 'eval_runtime': 0.7971, 'eval_samples_per_second': 412.728, 'eval_steps_per_second': 52.689, 'epoch': 13.0}\n","{'loss': 0.0248, 'learning_rate': 1.6723940435280642e-06, 'epoch': 13.75}\n","{'eval_loss': 0.1501259207725525, 'eval_mse': 0.1501259207725525, 'eval_rmse': 0.387460857629776, 'eval_mae': 0.29914191365242004, 'eval_r2': -0.23719427684078065, 'eval_smape': 64.84919975303951, 'eval_runtime': 0.7956, 'eval_samples_per_second': 413.509, 'eval_steps_per_second': 52.788, 'epoch': 14.0}\n","{'eval_loss': 0.14161425828933716, 'eval_mse': 0.14161425828933716, 'eval_rmse': 0.37631669640541077, 'eval_mae': 0.29141750931739807, 'eval_r2': -0.16704930784121763, 'eval_smape': 64.48318768996961, 'eval_runtime': 0.7965, 'eval_samples_per_second': 413.046, 'eval_steps_per_second': 52.729, 'epoch': 15.0}\n","{'train_runtime': 645.0659, 'train_samples_per_second': 53.994, 'train_steps_per_second': 6.767, 'train_loss': 0.057625682083601804, 'epoch': 15.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=4365, training_loss=0.057625682083601804, metrics={'train_runtime': 645.0659, 'train_samples_per_second': 53.994, 'train_steps_per_second': 6.767, 'train_loss': 0.057625682083601804, 'epoch': 15.0})"]},"metadata":{},"execution_count":101}],"source":["from transformers import Trainer, EarlyStoppingCallback\n","\n","# Call the Trainer\n","trainer = Trainer(\n","    model = model,                         \n","    args = training_args,                  \n","    train_dataset = data_encodings['train'],         \n","    eval_dataset = data_encodings['validation'],          \n","    compute_metrics = compute_metrics_for_regression,    \n","    callbacks=[EarlyStoppingCallback(5, 0.0)] \n",")\n","\n","# Train the model\n","trainer.train()"]},{"cell_type":"code","execution_count":102,"metadata":{"id":"Mf19DwNAwutN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684936915814,"user_tz":-120,"elapsed":574,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"3ed2a5f0-65b4-42ee-c097-3cca24361582"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.1501259207725525, 'eval_mse': 0.1501259207725525, 'eval_rmse': 0.387460857629776, 'eval_mae': 0.29914191365242004, 'eval_r2': -0.23719427684078065, 'eval_smape': 64.84919975303951, 'eval_runtime': 0.8645, 'eval_samples_per_second': 380.551, 'eval_steps_per_second': 48.581, 'epoch': 15.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.1501259207725525,\n"," 'eval_mse': 0.1501259207725525,\n"," 'eval_rmse': 0.387460857629776,\n"," 'eval_mae': 0.29914191365242004,\n"," 'eval_r2': -0.23719427684078065,\n"," 'eval_smape': 64.84919975303951,\n"," 'eval_runtime': 0.8645,\n"," 'eval_samples_per_second': 380.551,\n"," 'eval_steps_per_second': 48.581,\n"," 'epoch': 15.0}"]},"metadata":{},"execution_count":102}],"source":["trainer.evaluate()"]},{"cell_type":"code","execution_count":103,"metadata":{"id":"8Nebpu_swxep","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684936917577,"user_tz":-120,"elapsed":1765,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"8baef91d-d2bb-4fae-d9e9-feeb5c92fda5"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.15764868259429932, 'eval_mse': 0.15764868259429932, 'eval_rmse': 0.3970499634742737, 'eval_mae': 0.30675747990608215, 'eval_r2': -0.3268222184417626, 'eval_smape': 65.27405828335831, 'eval_runtime': 1.6086, 'eval_samples_per_second': 414.635, 'eval_steps_per_second': 52.218, 'epoch': 15.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.15764868259429932,\n"," 'eval_mse': 0.15764868259429932,\n"," 'eval_rmse': 0.3970499634742737,\n"," 'eval_mae': 0.30675747990608215,\n"," 'eval_r2': -0.3268222184417626,\n"," 'eval_smape': 65.27405828335831,\n"," 'eval_runtime': 1.6086,\n"," 'eval_samples_per_second': 414.635,\n"," 'eval_steps_per_second': 52.218,\n"," 'epoch': 15.0}"]},"metadata":{},"execution_count":103}],"source":["trainer.eval_dataset = data_encodings['test']\n","trainer.evaluate()"]},{"cell_type":"code","execution_count":104,"metadata":{"id":"SZbzOylrwzH9","executionInfo":{"status":"ok","timestamp":1684936917577,"user_tz":-120,"elapsed":2,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["def get_prediction(text):\n","    # prepare our text into tokenized sequence\n","    inputs = tokenizer(text, max_length=MAX_LEN, padding=\"max_length\", truncation=True, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model(**inputs)   #output is a tensor\n","    return outputs[0].item()    #we only have to return the value of the tensor by using item()"]},{"cell_type":"code","execution_count":105,"metadata":{"id":"f_5Pjn6Yw0mZ","executionInfo":{"status":"ok","timestamp":1684936923265,"user_tz":-120,"elapsed":5690,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["y_pred=[get_prediction(text) for text in dataset['validation']['Message']]"]},{"cell_type":"code","execution_count":106,"metadata":{"id":"O77RpRDow2sp","executionInfo":{"status":"ok","timestamp":1684936923265,"user_tz":-120,"elapsed":4,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","    \n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')\n","\n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"]},{"cell_type":"code","execution_count":107,"metadata":{"id":"FkdfE-qW7y_9","executionInfo":{"status":"ok","timestamp":1684936923266,"user_tz":-120,"elapsed":5,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["y_train = data_encodings['train']['label']\n","y_val = data_encodings['validation']['label']\n","y_test = data_encodings['test']['label']"]},{"cell_type":"code","execution_count":108,"metadata":{"id":"yuJIBWvo7ddz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684936923266,"user_tz":-120,"elapsed":4,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"40a6f26e-6f22-4d80-e2c6-28d619d38262"},"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.15|0.39|0.30|-0.24|64.85|0.34|\n"]}],"source":["#print_metrics(y_test, y_pred)\n","print_metrics(y_val, y_pred)"]},{"cell_type":"code","execution_count":109,"metadata":{"id":"iKs5yju97KRp","executionInfo":{"status":"ok","timestamp":1684936923266,"user_tz":-120,"elapsed":4,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["with open(\"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/task2_gold_b.txt\") as file:\n","  final_labels_list = file.readlines()\n","final_labels_list\n","\n","final_labels = {}\n","\n","for label in final_labels_list:\n","  if label == final_labels_list[0]:\n","    continue\n","\n","  key = \"\"\n","  value = \"\"\n","\n","  comma = False\n","  for letter in label:\n","    if letter == '\\n':\n","      continue\n","    if letter == ',':\n","      comma = True\n","      continue\n","    if not comma:\n","      key += letter\n","    else:\n","      value += letter\n","  \n","  final_labels[key] = float(value)\n"]},{"cell_type":"code","execution_count":110,"metadata":{"id":"G_i-aKG96jfm","executionInfo":{"status":"ok","timestamp":1684936927974,"user_tz":-120,"elapsed":4711,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"outputs":[],"source":["predicted_labels = {}\n","for subject in final_labels:\n","  predicted_labels[subject] = 0\n","for index,text in enumerate(data_validation['Message']):\n","  pred = get_prediction(text)\n","  if pred > predicted_labels[data_validation[index]['Subject']]:\n","    predicted_labels[data_validation[index]['Subject']] = pred"]},{"cell_type":"code","source":["x = list(final_labels.values())\n","y = list(predicted_labels.values())"],"metadata":{"id":"ehxbMm23HTUz","executionInfo":{"status":"ok","timestamp":1684936927974,"user_tz":-120,"elapsed":14,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":111,"outputs":[]},{"cell_type":"code","source":["for i in range(len(x)):\n","  if (x[i] == y[i]):\n","    y[i] += 0.001"],"metadata":{"id":"asujFnfuHXfQ","executionInfo":{"status":"ok","timestamp":1684936927974,"user_tz":-120,"elapsed":13,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":112,"outputs":[]},{"cell_type":"code","execution_count":113,"metadata":{"id":"gifmJ0JEJtcU","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684936927975,"user_tz":-120,"elapsed":14,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"9a7bb6f4-2a51-41a3-e63a-59f8a8a1b5d4"},"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.26|0.51|0.40|-0.97|104.14|0.11|\n"]}],"source":["print_metrics(x,y)"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"ee6bb0ab85384701a158a9868a673dea":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d6689ec7f5544fe6b9f2b2e430b9be01","IPY_MODEL_363be68ae4fa4c15990d8a1a819785c8","IPY_MODEL_b7d915adfc954ac597488400062ec89f"],"layout":"IPY_MODEL_a2593bc6c7b74d0f870968322c802246"}},"d6689ec7f5544fe6b9f2b2e430b9be01":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4c907b4bb4dc4da0a90445677e3ea498","placeholder":"​","style":"IPY_MODEL_89e54d81a6a749a98326e3f831789fe0","value":"Downloading data files: 100%"}},"363be68ae4fa4c15990d8a1a819785c8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b32255a86e764bbc93f6a947ade769e2","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_976855958d5f45988a8d7c3781b071e9","value":1}},"b7d915adfc954ac597488400062ec89f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_78dcf66d1291441bb5117965802a746c","placeholder":"​","style":"IPY_MODEL_2edea6c2f06b4d93ac6e4d27805c9654","value":" 1/1 [00:00&lt;00:00, 24.81it/s]"}},"a2593bc6c7b74d0f870968322c802246":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4c907b4bb4dc4da0a90445677e3ea498":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"89e54d81a6a749a98326e3f831789fe0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b32255a86e764bbc93f6a947ade769e2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"976855958d5f45988a8d7c3781b071e9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"78dcf66d1291441bb5117965802a746c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2edea6c2f06b4d93ac6e4d27805c9654":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"420183fbcdee4068b4db6b69a37d650c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3d26fcecb38c46b0b655635e0b0e83ee","IPY_MODEL_035a6fe9a501481aaf168c29587ab5a9","IPY_MODEL_09d6561313d246928696d5cc60de3faa"],"layout":"IPY_MODEL_79a830b33ab646d99080fcb52ad0e534"}},"3d26fcecb38c46b0b655635e0b0e83ee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b608d03d860e4ac39cd364a608fc49ec","placeholder":"​","style":"IPY_MODEL_2a9144cdfbab41b790409a0010695448","value":"Extracting data files: 100%"}},"035a6fe9a501481aaf168c29587ab5a9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_6759c3d5643f4600b5f99de230c4fa2d","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_11b5dc301c3c466c8fae2084edb74e3b","value":1}},"09d6561313d246928696d5cc60de3faa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bccccd77e3de44248e8eca195d7671eb","placeholder":"​","style":"IPY_MODEL_fcf5a277711d45129834382ca75fff7a","value":" 1/1 [00:00&lt;00:00,  1.30it/s]"}},"79a830b33ab646d99080fcb52ad0e534":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b608d03d860e4ac39cd364a608fc49ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2a9144cdfbab41b790409a0010695448":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6759c3d5643f4600b5f99de230c4fa2d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"11b5dc301c3c466c8fae2084edb74e3b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bccccd77e3de44248e8eca195d7671eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fcf5a277711d45129834382ca75fff7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"867f2bd73a0e4a1bb2869d00d0b7acca":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a795d6c1be0048e495836466c5bd7e75","IPY_MODEL_643747b617d0408bbbb4d1fd7b5cb734","IPY_MODEL_6a0bcde364e34e569a9c6c2bc541157a"],"layout":"IPY_MODEL_2b2c095e5f1e424fac20d17d481c485a"}},"a795d6c1be0048e495836466c5bd7e75":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ec33c48345b84762a8ca17ae0f2a0c5a","placeholder":"​","style":"IPY_MODEL_46cce8f77c4d4e02a0e7a66faf914eb8","value":"Generating train split: "}},"643747b617d0408bbbb4d1fd7b5cb734":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_cb786c4ac524462491a2fe1dc11b7a8b","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b3ff0b3926b1419a9d57232b45b5dd9a","value":1}},"6a0bcde364e34e569a9c6c2bc541157a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7e37d179afcb42f0b4252757a563272a","placeholder":"​","style":"IPY_MODEL_6a301a7a395445ca8366afb936a87320","value":" 3318/0 [00:00&lt;00:00, 9233.94 examples/s]"}},"2b2c095e5f1e424fac20d17d481c485a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"ec33c48345b84762a8ca17ae0f2a0c5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"46cce8f77c4d4e02a0e7a66faf914eb8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"cb786c4ac524462491a2fe1dc11b7a8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"b3ff0b3926b1419a9d57232b45b5dd9a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7e37d179afcb42f0b4252757a563272a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6a301a7a395445ca8366afb936a87320":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4e64ac11ddf544c2b5ace3ede8b707d9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6a61bba7d6bc419b957509e49b342561","IPY_MODEL_fe0fd0b0b166482591a0f358e7e544fe","IPY_MODEL_b95074a7584b4278a3360433ea3bc538"],"layout":"IPY_MODEL_89d0362076864014b35fe003b5c8e90c"}},"6a61bba7d6bc419b957509e49b342561":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f8b28131ed6249b6a9d4225e50b397e4","placeholder":"​","style":"IPY_MODEL_9ab7d104d95449b28918b21aa78b6179","value":"100%"}},"fe0fd0b0b166482591a0f358e7e544fe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ae90872ceb474ec28a09db2b4425ff1a","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_586149aa26db4e95a3cddb851c57ce19","value":1}},"b95074a7584b4278a3360433ea3bc538":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0b5610a847fe402dafb83a76dc94d3d2","placeholder":"​","style":"IPY_MODEL_0d6e7fd0e3424681924f82107faeaa34","value":" 1/1 [00:00&lt;00:00, 34.02it/s]"}},"89d0362076864014b35fe003b5c8e90c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f8b28131ed6249b6a9d4225e50b397e4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"9ab7d104d95449b28918b21aa78b6179":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ae90872ceb474ec28a09db2b4425ff1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"586149aa26db4e95a3cddb851c57ce19":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0b5610a847fe402dafb83a76dc94d3d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0d6e7fd0e3424681924f82107faeaa34":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b96e3c05c6ba429ca052ccd964213a84":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9b52bf78684b4ad9916995451f9cc754","IPY_MODEL_36835cdab35c4bccbc4eae75c6991652","IPY_MODEL_4d85ac9607b841bc932719fe0f731771"],"layout":"IPY_MODEL_c3f2727e8e544ae5bba04013a843f849"}},"9b52bf78684b4ad9916995451f9cc754":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_3f0386f35bbc406b82fa4a6c8e47c793","placeholder":"​","style":"IPY_MODEL_0a9fa5372a024c3495abfe1c0efb3e6e","value":"Map: 100%"}},"36835cdab35c4bccbc4eae75c6991652":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_36cbf8b961d84a9aa34c651725b6fe81","max":667,"min":0,"orientation":"horizontal","style":"IPY_MODEL_280862f79a6a403fa765d8f6e11345c3","value":667}},"4d85ac9607b841bc932719fe0f731771":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_983e71afa6684a17a87c5d0513f220c0","placeholder":"​","style":"IPY_MODEL_7e2c5768118f4eca9759f86f3e2cab54","value":" 667/667 [00:00&lt;00:00, 3305.73 examples/s]"}},"c3f2727e8e544ae5bba04013a843f849":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"3f0386f35bbc406b82fa4a6c8e47c793":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a9fa5372a024c3495abfe1c0efb3e6e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"36cbf8b961d84a9aa34c651725b6fe81":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"280862f79a6a403fa765d8f6e11345c3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"983e71afa6684a17a87c5d0513f220c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7e2c5768118f4eca9759f86f3e2cab54":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"fef044e3e9354c0784245a4d24e0ee17":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_10d3f32e91b3465c8f40bc6956ada037","IPY_MODEL_4e66142ae3764fbe94ab2ccee99dbf5b","IPY_MODEL_9a88245df430417a86d23d83012a7d1a"],"layout":"IPY_MODEL_f3dfc374a471491e9fa55380c5ef8b70"}},"10d3f32e91b3465c8f40bc6956ada037":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e0a04dd05f8c43a0886af820054fdacb","placeholder":"​","style":"IPY_MODEL_61a9e072cd37468b89734d2aca9e579b","value":"Downloading (…)lve/main/config.json: 100%"}},"4e66142ae3764fbe94ab2ccee99dbf5b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_315aaf810e0441baa873519cabb51b5a","max":430,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0a250257c924476b8f970479e606bc9f","value":430}},"9a88245df430417a86d23d83012a7d1a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d3521614a5ab4265946d481266fb0f38","placeholder":"​","style":"IPY_MODEL_6f35f08ed9b249d887b34c822c3f2a8c","value":" 430/430 [00:00&lt;00:00, 10.8kB/s]"}},"f3dfc374a471491e9fa55380c5ef8b70":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e0a04dd05f8c43a0886af820054fdacb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"61a9e072cd37468b89734d2aca9e579b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"315aaf810e0441baa873519cabb51b5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a250257c924476b8f970479e606bc9f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d3521614a5ab4265946d481266fb0f38":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6f35f08ed9b249d887b34c822c3f2a8c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"06d8bd1092af4887ae89fcda75440020":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4ea09d1fea8e418fb77ba77b6b940987","IPY_MODEL_855aa51fee4a41a3bd9eb51a210e7260","IPY_MODEL_6667e626defb409ca0fb16212c17ec27"],"layout":"IPY_MODEL_b07e8b72d40d4e3a8a3561acffc7e415"}},"4ea09d1fea8e418fb77ba77b6b940987":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f6fef111c13143e698ecd42438401ed1","placeholder":"​","style":"IPY_MODEL_a914281aaff14739ad632bf7a1cb0f93","value":"Downloading pytorch_model.bin: 100%"}},"855aa51fee4a41a3bd9eb51a210e7260":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7868530dec23498abf16a3d8938ed0e6","max":470657952,"min":0,"orientation":"horizontal","style":"IPY_MODEL_cb4e14129cdb40bd9e791437a4214c34","value":470657952}},"6667e626defb409ca0fb16212c17ec27":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f86d23bced8c484b9076be616fbb3788","placeholder":"​","style":"IPY_MODEL_995d84ae467640a4848fe3bbdcb067da","value":" 471M/471M [00:05&lt;00:00, 52.0MB/s]"}},"b07e8b72d40d4e3a8a3561acffc7e415":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f6fef111c13143e698ecd42438401ed1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a914281aaff14739ad632bf7a1cb0f93":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7868530dec23498abf16a3d8938ed0e6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb4e14129cdb40bd9e791437a4214c34":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"f86d23bced8c484b9076be616fbb3788":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"995d84ae467640a4848fe3bbdcb067da":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}