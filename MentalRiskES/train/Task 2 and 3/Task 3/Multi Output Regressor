{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"b683694d6c9246d780df786528831e8b":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8f4ac08554cf40688c96807405666dfb","IPY_MODEL_9512aca2b670444ea77d13935b07e8e3","IPY_MODEL_c747649f9fc341468a8c956f0ca0044e"],"layout":"IPY_MODEL_6a7e6edd23f34bcc9bf51ee2668c24ab"}},"8f4ac08554cf40688c96807405666dfb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c3737d8c0c194ef78f15666000911d15","placeholder":"​","style":"IPY_MODEL_92f99666fa3d41ada52f7909a97879eb","value":"Downloading data files: 100%"}},"9512aca2b670444ea77d13935b07e8e3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_550f1a4e3c8b424489a080a54a9c77a2","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_1d8d2fc754004a6799b543b91e63d70c","value":1}},"c747649f9fc341468a8c956f0ca0044e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_66d17acd42b44ad89f9c2a156a93746b","placeholder":"​","style":"IPY_MODEL_31a8edcf1be34afc9279060350fe38bc","value":" 1/1 [00:00&lt;00:00, 24.48it/s]"}},"6a7e6edd23f34bcc9bf51ee2668c24ab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c3737d8c0c194ef78f15666000911d15":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"92f99666fa3d41ada52f7909a97879eb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"550f1a4e3c8b424489a080a54a9c77a2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1d8d2fc754004a6799b543b91e63d70c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"66d17acd42b44ad89f9c2a156a93746b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"31a8edcf1be34afc9279060350fe38bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d5761d25dcde4c1d94076a70ca7a72a3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a303b74353ce4c72a2e247e88e88bb19","IPY_MODEL_e84c1b4f04a44d17b823f00926012331","IPY_MODEL_eb417704f5644e5f8ebb2f82805a2ec1"],"layout":"IPY_MODEL_07c6ee9331e04d398564980e09793287"}},"a303b74353ce4c72a2e247e88e88bb19":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_beaeba39d32d4a7fbb729936faf3e752","placeholder":"​","style":"IPY_MODEL_85703eeae4a64a99b861a8a4b720c217","value":"Extracting data files: 100%"}},"e84c1b4f04a44d17b823f00926012331":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_410f6d08188a4f9dbda22f1d06d0f231","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_095269c45f2c439387aa69bea74ea25f","value":1}},"eb417704f5644e5f8ebb2f82805a2ec1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14f3fd1197f849cfa2658a5d57c603c5","placeholder":"​","style":"IPY_MODEL_38c02f4077a8457884d69f966f6a362c","value":" 1/1 [00:00&lt;00:00,  2.20it/s]"}},"07c6ee9331e04d398564980e09793287":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"beaeba39d32d4a7fbb729936faf3e752":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"85703eeae4a64a99b861a8a4b720c217":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"410f6d08188a4f9dbda22f1d06d0f231":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"095269c45f2c439387aa69bea74ea25f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"14f3fd1197f849cfa2658a5d57c603c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38c02f4077a8457884d69f966f6a362c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f3fd5087330e41b5978ff7cb5b6860f3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_da9cedfa03b541dbbfb239b2c7513730","IPY_MODEL_c6da844d9b884310b4d224459924eb26","IPY_MODEL_075de55e9090492d87a4f35cdc0e6c81"],"layout":"IPY_MODEL_2a0a655168254adc8d0045607545975b"}},"da9cedfa03b541dbbfb239b2c7513730":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_898243f2045e4ef3b7b99e0353f0d068","placeholder":"​","style":"IPY_MODEL_27addb6ce1924c319c2fec0a63517f54","value":"Generating train split: "}},"c6da844d9b884310b4d224459924eb26":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_977470a66a0b44558f5a18f99b8c0071","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_f8a2c2b216d4426abc2735a383fd9931","value":1}},"075de55e9090492d87a4f35cdc0e6c81":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e83c9ee588fd4ef889bee28b729b5aa2","placeholder":"​","style":"IPY_MODEL_297cf605543d4f259cbd6aa81d3e593c","value":" 175/0 [00:00&lt;00:00, 1658.45 examples/s]"}},"2a0a655168254adc8d0045607545975b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"898243f2045e4ef3b7b99e0353f0d068":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"27addb6ce1924c319c2fec0a63517f54":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"977470a66a0b44558f5a18f99b8c0071":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"f8a2c2b216d4426abc2735a383fd9931":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e83c9ee588fd4ef889bee28b729b5aa2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"297cf605543d4f259cbd6aa81d3e593c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"14f428210c7c4415b65496ad5003e59a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d14064045b63416ca8c32b54f3b7d219","IPY_MODEL_c2d6de8c3e3047bf8e38a12461896fc0","IPY_MODEL_8cc1f300685649ffbc148f8cce90b26f"],"layout":"IPY_MODEL_bb197302c1d645f9b1893b055b250e7c"}},"d14064045b63416ca8c32b54f3b7d219":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4ba4c9a408fa428f8428a3ae7b0c048f","placeholder":"​","style":"IPY_MODEL_bd2bd28f5318408e8639f2535671da30","value":"100%"}},"c2d6de8c3e3047bf8e38a12461896fc0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_9c84094f32d04296b8c3bf35182f6257","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_e5d044a62a4a4280ab6c1551c4dbbe6a","value":1}},"8cc1f300685649ffbc148f8cce90b26f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ece3c00541204444b32f3ca8561c64e3","placeholder":"​","style":"IPY_MODEL_402b4b5a0a68478db6b3384478c732bd","value":" 1/1 [00:00&lt;00:00, 32.26it/s]"}},"bb197302c1d645f9b1893b055b250e7c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ba4c9a408fa428f8428a3ae7b0c048f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bd2bd28f5318408e8639f2535671da30":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9c84094f32d04296b8c3bf35182f6257":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e5d044a62a4a4280ab6c1551c4dbbe6a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"ece3c00541204444b32f3ca8561c64e3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"402b4b5a0a68478db6b3384478c732bd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"33ecf19cff8f4e839ea451cf4873b158":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a94091555afa4ff0a5f4bf920902d217","IPY_MODEL_5f2d48604f6347a5a5d534d1de63821b","IPY_MODEL_849e1c07ae3a4d2091d295543c239cf2"],"layout":"IPY_MODEL_1b2886e6eb7d4a41aa119bcd5c8cb2fa"}},"a94091555afa4ff0a5f4bf920902d217":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8cbc4d4ac2e14068a0a4579619370856","placeholder":"​","style":"IPY_MODEL_8b3767842eeb44a8be60a64c65160eb7","value":"Map: 100%"}},"5f2d48604f6347a5a5d534d1de63821b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_c0e2ed4cb6144bc3b606f9d812d1285f","max":35,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ad8997bf67d64ce49a362175ea124b39","value":35}},"849e1c07ae3a4d2091d295543c239cf2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d0e6d3e07ac74817a3f0b15600a3221c","placeholder":"​","style":"IPY_MODEL_df4ffcd7553b4d4888970864ca5cb09f","value":" 35/35 [00:00&lt;00:00, 204.57 examples/s]"}},"1b2886e6eb7d4a41aa119bcd5c8cb2fa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"8cbc4d4ac2e14068a0a4579619370856":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8b3767842eeb44a8be60a64c65160eb7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c0e2ed4cb6144bc3b606f9d812d1285f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ad8997bf67d64ce49a362175ea124b39":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d0e6d3e07ac74817a3f0b15600a3221c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df4ffcd7553b4d4888970864ca5cb09f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":1,"metadata":{"id":"_BiM0RepL_H6","executionInfo":{"status":"ok","timestamp":1685107771528,"user_tz":-120,"elapsed":23610,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"6e42f0e2-e36e-451c-81ab-3ab75d3332f1"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["!pip install datasets transformers accelerate"],"metadata":{"id":"wCWqtrBkuBp9","executionInfo":{"status":"ok","timestamp":1685107792050,"user_tz":-120,"elapsed":20524,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"802019a4-a0a6-4aa6-fc25-75755a16ec60"},"execution_count":2,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.12.0-py3-none-any.whl (474 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m474.6/474.6 kB\u001b[0m \u001b[31m22.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting transformers\n","  Downloading transformers-4.29.2-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m114.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.19.0-py3-none-any.whl (219 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m219.1/219.1 kB\u001b[0m \u001b[31m29.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m16.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m28.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m19.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m67.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m20.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Collecting responses<0.19 (from datasets)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m88.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m17.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m28.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m21.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, xxhash, multidict, frozenlist, dill, async-timeout, yarl, responses, multiprocess, huggingface-hub, aiosignal, transformers, aiohttp, datasets, accelerate\n","Successfully installed accelerate-0.19.0 aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.12.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.14.1 multidict-6.0.4 multiprocess-0.70.14 responses-0.18.0 tokenizers-0.13.3 transformers-4.29.2 xxhash-3.2.0 yarl-1.9.2\n"]}]},{"cell_type":"code","source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"],"metadata":{"id":"13dCqvZhuxs_","executionInfo":{"status":"ok","timestamp":1685107792559,"user_tz":-120,"elapsed":512,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"19469ea5-a934-42b1-bef9-537e7d9ed0ae"},"execution_count":3,"outputs":[{"output_type":"stream","name":"stdout","text":["Fri May 26 13:29:51 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   37C    P8     9W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"],"metadata":{"id":"4evkaVy1u46V","executionInfo":{"status":"ok","timestamp":1685107794214,"user_tz":-120,"elapsed":1656,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 2/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"task2_all_subjects_all_text_csv.csv\")\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":277,"referenced_widgets":["b683694d6c9246d780df786528831e8b","8f4ac08554cf40688c96807405666dfb","9512aca2b670444ea77d13935b07e8e3","c747649f9fc341468a8c956f0ca0044e","6a7e6edd23f34bcc9bf51ee2668c24ab","c3737d8c0c194ef78f15666000911d15","92f99666fa3d41ada52f7909a97879eb","550f1a4e3c8b424489a080a54a9c77a2","1d8d2fc754004a6799b543b91e63d70c","66d17acd42b44ad89f9c2a156a93746b","31a8edcf1be34afc9279060350fe38bc","d5761d25dcde4c1d94076a70ca7a72a3","a303b74353ce4c72a2e247e88e88bb19","e84c1b4f04a44d17b823f00926012331","eb417704f5644e5f8ebb2f82805a2ec1","07c6ee9331e04d398564980e09793287","beaeba39d32d4a7fbb729936faf3e752","85703eeae4a64a99b861a8a4b720c217","410f6d08188a4f9dbda22f1d06d0f231","095269c45f2c439387aa69bea74ea25f","14f3fd1197f849cfa2658a5d57c603c5","38c02f4077a8457884d69f966f6a362c","f3fd5087330e41b5978ff7cb5b6860f3","da9cedfa03b541dbbfb239b2c7513730","c6da844d9b884310b4d224459924eb26","075de55e9090492d87a4f35cdc0e6c81","2a0a655168254adc8d0045607545975b","898243f2045e4ef3b7b99e0353f0d068","27addb6ce1924c319c2fec0a63517f54","977470a66a0b44558f5a18f99b8c0071","f8a2c2b216d4426abc2735a383fd9931","e83c9ee588fd4ef889bee28b729b5aa2","297cf605543d4f259cbd6aa81d3e593c","14f428210c7c4415b65496ad5003e59a","d14064045b63416ca8c32b54f3b7d219","c2d6de8c3e3047bf8e38a12461896fc0","8cc1f300685649ffbc148f8cce90b26f","bb197302c1d645f9b1893b055b250e7c","4ba4c9a408fa428f8428a3ae7b0c048f","bd2bd28f5318408e8639f2535671da30","9c84094f32d04296b8c3bf35182f6257","e5d044a62a4a4280ab6c1551c4dbbe6a","ece3c00541204444b32f3ca8561c64e3","402b4b5a0a68478db6b3384478c732bd"]},"id":"FMiyJWAHMa4-","executionInfo":{"status":"ok","timestamp":1685107796991,"user_tz":-120,"elapsed":2779,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"87046fdd-3b8b-4d21-a777-f7069a2e9513"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-417262ae04fee2ab/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b683694d6c9246d780df786528831e8b"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"d5761d25dcde4c1d94076a70ca7a72a3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f3fd5087330e41b5978ff7cb5b6860f3"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-417262ae04fee2ab/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"14f428210c7c4415b65496ad5003e59a"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 175\n","    })\n","})"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["dataset['train'][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Z_fyU-Eunev","executionInfo":{"status":"ok","timestamp":1685107796991,"user_tz":-120,"elapsed":10,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"6ca3903b-e9d0-41c0-db10-389b09e23611"},"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Message': \"volvi me extrañaron signo de interrogación. y tu pareja signo de interrogación. todo el credito de aqui es mio cara sonriendo ligeramente. da signo de interrogación. frikifriki cara revolviéndose de la risa. ah wey dedo índice hacia arriba tono de piel medio Billie. good bye mano saludando tono de piel medio. holis cara sonriendo con superioridad. la muerte es algo lindo cara con ceja alzada corazón negro. quiero we cara babeando. es q ya llegue a un limite cara de desaprobación. prefiero estar muerto q seguir en este planeta. y signo de interrogación. tengo 4 de diferentes tamaños. se viene story time cara de sueño. yo dorso de mano con índice a la derecha tono de piel claro medio dorso de mano con índice a la izquierda tono de piel claro medio. quien o q cara con ceja alzada. ella signo de interrogación. es q estoy por borrar todas mis redes sociales. ya tengo micro nuevo cara sonriendo con ojos sonrientes. en un rato contare algo. wee ya para cara sin expresión. de que signo de interrogación. weee cara sonriendo con sudor frío. anoche a las 12 plane suicidarme pero un sms lo cambio todo. tu cres que tengo miedo a morir signo de interrogación. hola a nadie cara sonriente. I'm nobody cara con ceja alzada. yesss ... cara de alivio. pues ni idea y tu. anoche fue una noche larga le conte a un amigo { ni tan amigo } le dije lo q paso y me dio una pastilla para veverlas antes de dormir eso fue a eso de las 11 y me siento como un zombie. fue una pastillas q le resetaron a el hace ya 2 meses el estaba igual q yo pero . asi se siente estar medicado signo de interrogación estar como quien dice cesado para no lastimarse signo de interrogación 🤦🏽\\u200d♂ si q es una m la vida. son las 4 y no puedo pararme siento q me caere. cara preocupada cara preocupada. mejor me quedo asi y ya me duermo si puedo. a ellos no les importo. todos mis problemas y pensamientos raros x q cres que nacieron signo de interrogación x ellos por etiquetarme como el mal hijo . como el que nunca mejora . como el q solo llama a la atencion y culpable de todo pero no entiendo en q fallo yo . { - No me drogo . No tengo amigos . No robo . No tengo ningun vicio y tampoco soy algo deceado cara decepcionada - }. si pero viven en otro estado q yo y no hablamos y es una M cara sonriendo ligeramente. no les dire nada muchos dicen q estaba bromeando sobre lo de anoche pero en mi cuarto a la ama ecer iba a ver una solpresa. digo al amanecer . 🤦🏽\\u200d♂ el teclado de la pc se me resvala. anoche iba a suicidarme cara con ojos en blanco. no lo hice xq llego una llamada de alguien muy especial para mi y le conte todo. tratare de dormir . apenas puedo con la laptop. ok . muchas gracias x todo chispas. val 3 ya vere lo q aga. ok no puedo dormir me siento horrible. hola @USER mano saludando tono de piel medio. hi Adan mano saludando tono de piel medio. flecha hacia arriba flecha hacia arriba flecha hacia arriba flecha hacia arriba. atencion signo de exclamación. holis cara sonriente. canzado cara revolviéndose de la risa. no se amaneci asi x una pastilla rara. yo me la paso durmiendo. we no te drogues. noup cara haciendo una mueca made in china ni china so n cara revolviéndose de la risa. COMO ESTAS signo de interrogación. my billie cara sin expresión. pues es mi fondo de escritorio de ella y tengo descargada todas sus musicas mi favorita ´ ´ lovely ´ ´ y tengo un mundo de todas de sus fts asi q creo q no soy fan. si son muy buena. hola cara de por favor signo de exclamación. buenas noches . bien y tu. calavera calavera calavera. Hambre cara sonriendo ligeramente. thanks cara sonriente. wee no lo agas. noooo pero eso se ve feo en un macho. puede ser xq mi primo finjio ser hetero x 5 años cara revolviéndose de la risa. talvez no es gay a lo mejor bisexual eso es bueno para ti cara sonriendo con sudor frío. y yo y en otra ventana juego among us. de nada we fue todo mi esfuerzo 🦸🏽\\u200d♂. q te pasa tuuuuu. yo see como no estar triste ya q calavera. real comprrobado x mi. holaaaa cara de alivio. depre signo de interrogación. muy bien por el momento y tu. esa el la actitud cara sonriendo con gafas de sol. wow cara sin boca. yo queria comprarme una luz led cara con el ceño fruncido. owww me quitaste las ganas cara revolviéndose de la risa. me voy para españa en yola quien me acepta ilegalmente cara sonriendo con los ojos cerrados cara sonriendo con los ojos cerrados cara sonriendo con los ojos cerrados. weeeee mejor paso cara llorando fuerte cara revolviéndose de la risa. que es eso birra signo de interrogación cara pensativa. yo solo tomo vino y champaña o tequila cara sonriendo con los ojos cerrados. no me gusta la cerveza. Dominican cara sonriendo con gafas de sol 🇩 🇴 chispas. por donde vivo es muy caro pero muy cara sonriendo con los ojos cerrados. vaya ami me gusta todo menos cerveza cara sonriendo con los ojos cerrados cara sonriendo con los ojos cerrados. woow extraño mi vida de 1 año atras. yo hace un año me pase de tequilas con mis primos y hasta bañarme tubieron cara sonriendo con los ojos cerrados cara sonriendo con los ojos cerrados cara sonriendo con los ojos cerrados. senti q la cama me daba vueltas y yo estaba asi .. cara de loco cara revolviéndose de la risa. Adan signo de interrogación. una pregunta 🤦🏽\\u200d♂. ufffffff somos grande cara revolviéndose de la risa calavera. yo desde un principio lo supe. esa muerte conmovio al mun 2. mi hermana lloro mucho con su muerte y yo quede ... cara con ceja alzada. si parece cara revolviéndose de la risa. pues nada ando aburrido no c que hacer cara sonriendo con los ojos cerrados. \",\n"," 'Subject': 'subject101',\n"," 'Label_b': 0.9,\n"," 'Suffer_in_favour': 0.7,\n"," 'Suffer_against': 0.1,\n"," 'Suffer_other': 0.1,\n"," 'Control': 0.1}"]},"metadata":{},"execution_count":6}]},{"cell_type":"code","source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2IvcYiBJ0JhT","executionInfo":{"status":"ok","timestamp":1685107796991,"user_tz":-120,"elapsed":8,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"ed51300a-218c-40fd-b93d-7381f0e67def"},"execution_count":7,"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 53\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 35\n","    })\n","    test: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 18\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control'],\n","        num_rows: 18\n","    })\n","})\n"]}]},{"cell_type":"code","source":["# MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","# MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base). \n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","# MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","# MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-MuWGUZOvBJu","executionInfo":{"status":"ok","timestamp":1685108304887,"user_tz":-120,"elapsed":2,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"6b3c53bd-fa92-4346-d838-322c178d5575"},"execution_count":131,"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: cardiffnlp/twitter-xlm-roberta-base\n"]}]},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else: \n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"],"metadata":{"id":"ljpBXXWTvF6b","executionInfo":{"status":"ok","timestamp":1685108306883,"user_tz":-120,"elapsed":1702,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":132,"outputs":[]},{"cell_type":"code","source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Message']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fo_-iSvrvIfk","executionInfo":{"status":"ok","timestamp":1685108307320,"user_tz":-120,"elapsed":439,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"b493c8b6-7d83-4e19-a546-38e82a9a4f02"},"execution_count":133,"outputs":[{"output_type":"execute_result","data":{"text/plain":["count     122.000000\n","mean      694.081967\n","std       687.855748\n","min       108.000000\n","25%       257.000000\n","50%       440.000000\n","75%       869.000000\n","85%      1238.200000\n","90%      1500.100000\n","95%      1910.050000\n","99%      2736.370000\n","max      5167.000000\n","dtype: float64"]},"metadata":{},"execution_count":133}]},{"cell_type":"markdown","source":["EJECUTAR HASTA AQUÍ PARA VER LA LEN"],"metadata":{"id":"lOL198jgvERj"}},{"cell_type":"code","source":["MAX_LEN = 512\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Message\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":322,"referenced_widgets":["33ecf19cff8f4e839ea451cf4873b158","a94091555afa4ff0a5f4bf920902d217","5f2d48604f6347a5a5d534d1de63821b","849e1c07ae3a4d2091d295543c239cf2","1b2886e6eb7d4a41aa119bcd5c8cb2fa","8cbc4d4ac2e14068a0a4579619370856","8b3767842eeb44a8be60a64c65160eb7","c0e2ed4cb6144bc3b606f9d812d1285f","ad8997bf67d64ce49a362175ea124b39","d0e6d3e07ac74817a3f0b15600a3221c","df4ffcd7553b4d4888970864ca5cb09f"]},"id":"MkV_0THcvUVE","executionInfo":{"status":"ok","timestamp":1685108307321,"user_tz":-120,"elapsed":4,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"9eb733b4-9757-4020-88c6-7f71e884a17a"},"execution_count":134,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/35 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"33ecf19cff8f4e839ea451cf4873b158"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Message', 'Subject', 'Label_b', 'Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":134}]},{"cell_type":"code","source":["data_encodings = data_encodings.remove_columns(['Message','Subject','Label_b'])\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_A3LcmxMwgo4","executionInfo":{"status":"ok","timestamp":1685108307620,"user_tz":-120,"elapsed":3,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"f971ffc2-89ea-481a-88b6-7e3ce462ad46"},"execution_count":135,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Suffer_in_favour', 'Suffer_against', 'Suffer_other', 'Control', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":135}]},{"cell_type":"code","source":["X_train = []\n","y_train = []\n","X_test = []\n","y_test = []\n","for data in data_encodings['train']:\n","  X_train.append(data['input_ids'])\n","  y_train.append([float(data['Suffer_in_favour']),float(data['Suffer_against']),float(data['Suffer_other']),float(data['Control'])])\n","for data in data_encodings['test']:\n","  X_test.append(data['input_ids'])\n","  y_test.append([float(data['Suffer_in_favour']),float(data['Suffer_against']),float(data['Suffer_other']),float(data['Control'])])"],"metadata":{"id":"8nD_uBHTqBl1","executionInfo":{"status":"ok","timestamp":1685108307620,"user_tz":-120,"elapsed":2,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":136,"outputs":[]},{"cell_type":"code","source":["import numpy as np\n","from sklearn.multioutput import MultiOutputRegressor\n","from sklearn.linear_model import Ridge\n","regr = MultiOutputRegressor(Ridge(random_state=123)).fit(X_train, y_train)\n","class_pred1 = []\n","class_pred2 = []\n","class_pred3 = []\n","class_pred4 = []\n","class1 = []\n","class2 = []\n","class3 = []\n","class4 = []\n","for i in range(len(X_test)):\n","  x = regr.predict([X_test[i]])\n","  class_pred1.append(x[0][0])\n","  class_pred2.append(x[0][1])\n","  class_pred3.append(x[0][2])\n","  class_pred4.append(x[0][3])\n","  class1.append(y_test[i][0])\n","  class2.append(y_test[i][1])\n","  class3.append(y_test[i][2])\n","  class4.append(y_test[i][3])"],"metadata":{"id":"1Hv-2M2IouNV","executionInfo":{"status":"ok","timestamp":1685108307621,"user_tz":-120,"elapsed":2,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":137,"outputs":[]},{"cell_type":"code","source":["from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","    \n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')\n","\n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"],"metadata":{"id":"IvIJHljJx7Qh","executionInfo":{"status":"ok","timestamp":1685108308115,"user_tz":-120,"elapsed":496,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":138,"outputs":[]},{"cell_type":"code","source":["print_metrics(class1,class_pred1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LoMnwDUix743","executionInfo":{"status":"ok","timestamp":1685108308116,"user_tz":-120,"elapsed":14,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"9f4ac0b3-ba16-4b94-de74-a88836591656"},"execution_count":139,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.14|0.37|0.30|-0.61|111.10|-0.14|\n"]}]},{"cell_type":"code","source":["print_metrics(class2,class_pred2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GPFGJ8e5ypxK","executionInfo":{"status":"ok","timestamp":1685108308116,"user_tz":-120,"elapsed":13,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"4549a151-ba86-47b1-c3dc-73902b7945d1"},"execution_count":140,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.07|0.26|0.20|-0.26|102.78|0.15|\n"]}]},{"cell_type":"code","source":["print_metrics(class3,class_pred3)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"T5pLR0R-yp5p","executionInfo":{"status":"ok","timestamp":1685108308116,"user_tz":-120,"elapsed":11,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"9a90be1b-28ab-45fe-e1ab-ce6c295ff67f"},"execution_count":141,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.02|0.14|0.10|-0.62|173.88|-0.27|\n"]}]},{"cell_type":"code","source":["print_metrics(class4,class_pred4)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"o34KpIfQyp_S","executionInfo":{"status":"ok","timestamp":1685108308116,"user_tz":-120,"elapsed":10,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"1b2e4727-9074-4d85-dd2f-cdda871a3b77"},"execution_count":142,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.21|0.46|0.40|-0.58|121.10|-0.11|\n"]}]},{"cell_type":"code","source":["X_val = []\n","y_val = []\n","for data in data_encodings['validation']:\n","  X_val.append(data['input_ids'])\n","  y_val.append([float(data['Suffer_in_favour']),float(data['Suffer_against']),float(data['Suffer_other']),float(data['Control'])])"],"metadata":{"id":"CoR6_s323yV3","executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":10,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":143,"outputs":[]},{"cell_type":"code","source":["for i in range(len(X_val)):\n","  x = regr.predict([X_val[i]])\n","  class_pred1.append(x[0][0])\n","  class_pred2.append(x[0][1])\n","  class_pred3.append(x[0][2])\n","  class_pred4.append(x[0][3])\n","  class1.append(y_val[i][0])\n","  class2.append(y_val[i][1])\n","  class3.append(y_val[i][2])\n","  class4.append(y_val[i][3])"],"metadata":{"id":"tLIHkqQ74Af4","executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":10,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}}},"execution_count":144,"outputs":[]},{"cell_type":"code","source":["print_metrics(class1,class_pred1)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":9,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"66434740-1928-41a3-cdf5-0a8f82bf829f","id":"Fn6wfCEB4Hjv"},"execution_count":145,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.13|0.37|0.30|-0.72|122.52|-0.08|\n"]}]},{"cell_type":"code","source":["print_metrics(class2,class_pred2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":8,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"f78097f6-68f8-4a97-a3ae-cb777f2db48a","id":"FdMzPJg84Hjv"},"execution_count":146,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.05|0.23|0.17|-0.17|96.70|0.26|\n"]}]},{"cell_type":"code","source":["print_metrics(class3,class_pred3)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":6,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"9b24bab6-0035-4e52-ada8-7f6683d75b93","id":"t8enBbC54Hjv"},"execution_count":147,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.02|0.13|0.10|-0.62|172.86|-0.21|\n"]}]},{"cell_type":"code","source":["print_metrics(class4,class_pred4)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1685108308117,"user_tz":-120,"elapsed":5,"user":{"displayName":"yusvf bdhsvf","userId":"05287574613804405690"}},"outputId":"a46bab25-8cee-4d3c-bcf2-91669e21881d","id":"CQ4Mr_TO4Hjv"},"execution_count":148,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.20|0.45|0.39|-0.52|111.66|-0.01|\n"]}]}]}