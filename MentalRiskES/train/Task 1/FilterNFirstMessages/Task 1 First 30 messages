{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyNvB7yMGEKOuUnnNCcPOZen"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"e67e89f0b064448ebdecfae981d48dd2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e3749c233e494e939d515b97664c89bc","IPY_MODEL_77aee5cd100e4242bf5b67cfe3a6aad3","IPY_MODEL_d18d116da38a4211a5edb4ebbea04dbc"],"layout":"IPY_MODEL_0c6137a7c1314827a45c0a48a90512c9"}},"e3749c233e494e939d515b97664c89bc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_04bd22c4d44b4aa29b6e520012974f6c","placeholder":"​","style":"IPY_MODEL_5586f16a58434164830225d62b02d427","value":"100%"}},"77aee5cd100e4242bf5b67cfe3a6aad3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_0c3285fd4e0b40af817d03be0dbb4bc2","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_d2161d1eb8a6403c8892e33b84a57524","value":1}},"d18d116da38a4211a5edb4ebbea04dbc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_42db34454b8d4b6887121145072939d5","placeholder":"​","style":"IPY_MODEL_1237124bf7824fc89265365c3bfa4b58","value":" 1/1 [00:00&lt;00:00, 26.04it/s]"}},"0c6137a7c1314827a45c0a48a90512c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"04bd22c4d44b4aa29b6e520012974f6c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5586f16a58434164830225d62b02d427":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0c3285fd4e0b40af817d03be0dbb4bc2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d2161d1eb8a6403c8892e33b84a57524":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"42db34454b8d4b6887121145072939d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1237124bf7824fc89265365c3bfa4b58":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8561747f72c9431fb30d4b0d1ae42d55":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_baaa6c0578f6496dbd32f71786d94d66","IPY_MODEL_af1e8fac71d44401a92819ab9c7cec64","IPY_MODEL_b9b3955aad824bacb9c5fca616470d7a"],"layout":"IPY_MODEL_d05a6853ec614569a7f9c1dbd321327c"}},"baaa6c0578f6496dbd32f71786d94d66":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b11e38c9892142519001ade2c264ea93","placeholder":"​","style":"IPY_MODEL_f2edd201a14a40d5b9063dfd2327a8de","value":"Map:   0%"}},"af1e8fac71d44401a92819ab9c7cec64":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_154aff47392242cea6227aa69fd09e4e","max":35,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4b59035352474ed395ce99238d2be1f8","value":35}},"b9b3955aad824bacb9c5fca616470d7a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bd06e0f809024abf925372cdf588397a","placeholder":"​","style":"IPY_MODEL_8392bced59e04a3cb297f37504fb2c40","value":" 0/35 [00:00&lt;?, ? examples/s]"}},"d05a6853ec614569a7f9c1dbd321327c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"b11e38c9892142519001ade2c264ea93":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f2edd201a14a40d5b9063dfd2327a8de":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"154aff47392242cea6227aa69fd09e4e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4b59035352474ed395ce99238d2be1f8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bd06e0f809024abf925372cdf588397a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8392bced59e04a3cb297f37504fb2c40":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e53a6d1954aa4f3cbf75d798181a69ea":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_98e5ff9ec6ed455db3dfd41c8c997b34","IPY_MODEL_fb218b33ede54f2291d8202dceb762e7","IPY_MODEL_4add9c6c547140eab939b6c628df651a"],"layout":"IPY_MODEL_77c17991a0ae489b87d69f5169f6ce25"}},"98e5ff9ec6ed455db3dfd41c8c997b34":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e9b88841423640dd978c19b0f3c7db80","placeholder":"​","style":"IPY_MODEL_22a297dd7cf543a4b4925290fe4e6e7d","value":"Downloading (…)lve/main/config.json: 100%"}},"fb218b33ede54f2291d8202dceb762e7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ebfbbe4f09b443eb9d05c4acc0e34455","max":430,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4b5628d688b9420eb5c90ec7089d58d2","value":430}},"4add9c6c547140eab939b6c628df651a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a1759833975142e2934ae90442dfe37e","placeholder":"​","style":"IPY_MODEL_7268f422098f4317a3a601336c637b14","value":" 430/430 [00:00&lt;00:00, 29.9kB/s]"}},"77c17991a0ae489b87d69f5169f6ce25":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e9b88841423640dd978c19b0f3c7db80":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"22a297dd7cf543a4b4925290fe4e6e7d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ebfbbe4f09b443eb9d05c4acc0e34455":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4b5628d688b9420eb5c90ec7089d58d2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a1759833975142e2934ae90442dfe37e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7268f422098f4317a3a601336c637b14":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7081a917a4a6420dbf0d5e8f7f4a0336":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4e62a2a143be4d4ebf363cb52d7fa244","IPY_MODEL_f238a448a25c403faffdea481d25a250","IPY_MODEL_7d4c8641d486419d990ddd5cc37a977c"],"layout":"IPY_MODEL_4e361f02ffbf422d896453644ad82ab9"}},"4e62a2a143be4d4ebf363cb52d7fa244":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_f7098efab32f4c0d826018d633041717","placeholder":"​","style":"IPY_MODEL_fe9eef3c739a4cdca2b4ba396069987b","value":"Downloading pytorch_model.bin: 100%"}},"f238a448a25c403faffdea481d25a250":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3afc6a4b21554680995681d00debffac","max":470657952,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ae7d9e4c6f254362b1cbab3a1f729f32","value":470657952}},"7d4c8641d486419d990ddd5cc37a977c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b310b7d8d24c4ca885f1049b801e5f2d","placeholder":"​","style":"IPY_MODEL_ec004893fe544b47898ea26513a4ba90","value":" 471M/471M [00:14&lt;00:00, 30.1MB/s]"}},"4e361f02ffbf422d896453644ad82ab9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f7098efab32f4c0d826018d633041717":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fe9eef3c739a4cdca2b4ba396069987b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3afc6a4b21554680995681d00debffac":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ae7d9e4c6f254362b1cbab3a1f729f32":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b310b7d8d24c4ca885f1049b801e5f2d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec004893fe544b47898ea26513a4ba90":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install datasets transformers accelerate"],"metadata":{"id":"wCWqtrBkuBp9","executionInfo":{"status":"ok","timestamp":1684597083621,"user_tz":-120,"elapsed":8152,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"db6f21f5-07c3-4e47-bdb6-5d82a0b09ab5"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Requirement already satisfied: datasets in /usr/local/lib/python3.10/dist-packages (2.12.0)\n","Requirement already satisfied: transformers in /usr/local/lib/python3.10/dist-packages (4.29.2)\n","Collecting accelerate\n","  Downloading accelerate-0.19.0-py3-none-any.whl (219 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m219.1/219.1 kB\u001b[0m \u001b[31m6.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Requirement already satisfied: dill<0.3.7,>=0.3.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.3.6)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.2.0)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from datasets) (0.70.14)\n","Requirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.8.4)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.14.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Requirement already satisfied: responses<0.19 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.18.0)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: tokenizers!=0.11.3,<0.14,>=0.11.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (0.13.3)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.0.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.2)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.9.2)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.3)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: accelerate\n","Successfully installed accelerate-0.19.0\n"]}]},{"cell_type":"code","source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"],"metadata":{"id":"13dCqvZhuxs_","executionInfo":{"status":"ok","timestamp":1684597083621,"user_tz":-120,"elapsed":9,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"db12d5cf-e47d-424b-cd51-fa5a48c43455"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Sat May 20 15:38:02 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   63C    P8    11W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}]},{"cell_type":"code","source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"],"metadata":{"id":"4evkaVy1u46V"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"_BiM0RepL_H6","executionInfo":{"status":"ok","timestamp":1684597087955,"user_tz":-120,"elapsed":2028,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"dcc4c6c8-5a6a-4b2d-d7b0-3afa633b25b2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 1/FilterNFirstMessages/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"First30Messages.csv\")\n","dataset"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":157,"referenced_widgets":["e67e89f0b064448ebdecfae981d48dd2","e3749c233e494e939d515b97664c89bc","77aee5cd100e4242bf5b67cfe3a6aad3","d18d116da38a4211a5edb4ebbea04dbc","0c6137a7c1314827a45c0a48a90512c9","04bd22c4d44b4aa29b6e520012974f6c","5586f16a58434164830225d62b02d427","0c3285fd4e0b40af817d03be0dbb4bc2","d2161d1eb8a6403c8892e33b84a57524","42db34454b8d4b6887121145072939d5","1237124bf7824fc89265365c3bfa4b58"]},"id":"FMiyJWAHMa4-","executionInfo":{"status":"ok","timestamp":1684597088263,"user_tz":-120,"elapsed":311,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"bb1100af-bab4-4494-8ecb-b528753408c1"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e67e89f0b064448ebdecfae981d48dd2"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 175\n","    })\n","})"]},"metadata":{},"execution_count":5}]},{"cell_type":"code","source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0SxeW28IM7Va","executionInfo":{"status":"ok","timestamp":1684597088264,"user_tz":-120,"elapsed":10,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"6cc3660e-6d26-4d18-cfcf-6faabf09f342"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 53\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 35\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 18\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Subject', 'Text', 'label'],\n","        num_rows: 18\n","    })\n","})\n"]}]},{"cell_type":"code","source":["dataset['train'][0]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"2Z_fyU-Eunev","executionInfo":{"status":"ok","timestamp":1684597088264,"user_tz":-120,"elapsed":8,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"ecfeeac8-06a6-49fe-a13d-6ee945399df9"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Subject': 'subject12',\n"," 'Text': \"Holi me presento Soy cartof tengo 15 años are 16 la última vez que me pese fue hace bastante desgraciadamente pesaba 68 ' 4 mi meta final es llegar a los 50 soy mía. Que tal lo llevan. Holii ya las leí con respecto la 13 no soy mayor de edad cara sonriendo con sudor frío tengo 15 para 16. X2 el confinamiento me está fastidiando. Valep corazón morado. Yo llevo algo mal lo de estar encerrada con mis padres aparten me obligan a comer. Pero estoy compensando haciendo mucho deporte. Yo me tumbo en el suelo ates de dormir a hacer abdominales y intento hacer ejercicio por la mañana. Que haces con la silla ? ?. Pues voy ha hacerle una tarta de cumpleaños a mi padre y me alegra por qué me gusta cocinar pero no quiero comer :(. Como la sensación de comer ?. Otra cosa que funciona es ponerle algún sabor desagradable y no tóxico así no querrás comer. Obviamente si solo lo comeréis vosotras. Por ejemplo yo aveces cuando se que necesito comer pero no me quiero pasar le echo picante a mí comida. Mascar hielo también sirve xd a mí lo de masticar y escupir no me sirve\",\n"," 'label': 1.0}"]},"metadata":{},"execution_count":7}]},{"cell_type":"code","source":["MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","# MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","# MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base).\n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","# MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","# MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"-MuWGUZOvBJu","executionInfo":{"status":"ok","timestamp":1684600001122,"user_tz":-120,"elapsed":228,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"0173b6e9-0342-4573-8f5b-4d147596cd7a"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: microsoft/Multilingual-MiniLM-L12-H384\n"]}]},{"cell_type":"code","source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else:\n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"],"metadata":{"id":"ljpBXXWTvF6b"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Text']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Fo_-iSvrvIfk","executionInfo":{"status":"ok","timestamp":1684600003864,"user_tz":-120,"elapsed":579,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"0d62a483-21a6-4878-edd0-21f93777cff0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["count     122.000000\n","mean      562.696721\n","std       948.535016\n","min       110.000000\n","25%       302.000000\n","50%       417.000000\n","75%       535.000000\n","85%       630.850000\n","90%       703.200000\n","95%       926.750000\n","99%      4389.660000\n","max      9527.000000\n","dtype: float64"]},"metadata":{},"execution_count":82}]},{"cell_type":"markdown","source":["EJECUTAR HASTA AQUÍ PARA VER LA LEN"],"metadata":{"id":"lOL198jgvERj"}},{"cell_type":"code","source":["MAX_LEN = 512\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Text\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":268,"referenced_widgets":["8561747f72c9431fb30d4b0d1ae42d55","baaa6c0578f6496dbd32f71786d94d66","af1e8fac71d44401a92819ab9c7cec64","b9b3955aad824bacb9c5fca616470d7a","d05a6853ec614569a7f9c1dbd321327c","b11e38c9892142519001ade2c264ea93","f2edd201a14a40d5b9063dfd2327a8de","154aff47392242cea6227aa69fd09e4e","4b59035352474ed395ce99238d2be1f8","bd06e0f809024abf925372cdf588397a","8392bced59e04a3cb297f37504fb2c40"]},"id":"MkV_0THcvUVE","executionInfo":{"status":"ok","timestamp":1684600003864,"user_tz":-120,"elapsed":10,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"a4ea57ad-d5c8-4359-82e0-bdafdf19c1c4"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/35 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8561747f72c9431fb30d4b0d1ae42d55"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['Subject', 'Text', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":83}]},{"cell_type":"code","source":["data_encodings = data_encodings.remove_columns(['Text','Subject'])\n","data_encodings"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_A3LcmxMwgo4","executionInfo":{"status":"ok","timestamp":1684600003864,"user_tz":-120,"elapsed":8,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"98ac6e5f-5f26-49a4-c97b-4801c756aca5"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 122\n","    })\n","    test: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 35\n","    })\n","    validation: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 18\n","    })\n","})"]},"metadata":{},"execution_count":84}]},{"cell_type":"code","source":["from transformers import AutoModelForSequenceClassification\n","# As num_labes is 1, the AutoModelForSequenceClassification will trigger the linear regression and use MSELoss() as the loss function automatically.\n","model = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_labels = 1).to(\"cuda\")"],"metadata":{"id":"o4YciE87wXsR","executionInfo":{"status":"ok","timestamp":1684600020362,"user_tz":-120,"elapsed":16503,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["e53a6d1954aa4f3cbf75d798181a69ea","98e5ff9ec6ed455db3dfd41c8c997b34","fb218b33ede54f2291d8202dceb762e7","4add9c6c547140eab939b6c628df651a","77c17991a0ae489b87d69f5169f6ce25","e9b88841423640dd978c19b0f3c7db80","22a297dd7cf543a4b4925290fe4e6e7d","ebfbbe4f09b443eb9d05c4acc0e34455","4b5628d688b9420eb5c90ec7089d58d2","a1759833975142e2934ae90442dfe37e","7268f422098f4317a3a601336c637b14","7081a917a4a6420dbf0d5e8f7f4a0336","4e62a2a143be4d4ebf363cb52d7fa244","f238a448a25c403faffdea481d25a250","7d4c8641d486419d990ddd5cc37a977c","4e361f02ffbf422d896453644ad82ab9","f7098efab32f4c0d826018d633041717","fe9eef3c739a4cdca2b4ba396069987b","3afc6a4b21554680995681d00debffac","ae7d9e4c6f254362b1cbab3a1f729f32","b310b7d8d24c4ca885f1049b801e5f2d","ec004893fe544b47898ea26513a4ba90"]},"outputId":"3508fa9c-be49-4e1f-bdf0-2335525e6406"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/430 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e53a6d1954aa4f3cbf75d798181a69ea"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading pytorch_model.bin:   0%|          | 0.00/471M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7081a917a4a6420dbf0d5e8f7f4a0336"}},"metadata":{}}]},{"cell_type":"code","source":["import numpy as np\n","from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","\n","    # loss metrics\n","    mse = mean_squared_error(labels, logits)\n","    rmse = mean_squared_error(labels, logits, squared=False)\n","    mae = mean_absolute_error(labels, logits)\n","    smape = 1/len(labels) * np.sum(2 * np.abs(logits-labels) / (np.abs(labels) + np.abs(logits))*100)\n","    # performance metrics\n","    r2 = r2_score(labels, logits)\n","    # pearson=stats.pearsonr(labels, logits)[0]\n","\n","    # we return a dictionary with all metrics\n","    # return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape, \"pearson\": pearson}\n","    return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape}"],"metadata":{"id":"Kn79dWOFwZxe"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import TrainingArguments\n","\n","\n","NUM_EPOCHS = 15 # we recommend at least 3\n","\n","# Specifiy the arguments for the trainer\n","training_args = TrainingArguments(\n","    output_dir ='./results',\n","    num_train_epochs = NUM_EPOCHS,\n","    per_device_train_batch_size = 8, # 128 in the paper\n","    per_device_eval_batch_size = 8,\n","    weight_decay = 0.01,\n","    learning_rate = 2e-5,  # 0.001 in the paper,\n","    logging_dir = './logs',\n","    save_total_limit = 10,\n","    load_best_model_at_end = True,\n","    metric_for_best_model = 'rmse',\n","    evaluation_strategy = \"epoch\",  # steps in the paper\n","    save_strategy = \"epoch\",    # steps in the paper\n","    report_to = 'all',\n",")"],"metadata":{"id":"pL_uOTjYwcSY"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import Trainer, EarlyStoppingCallback\n","\n","# Call the Trainer\n","trainer = Trainer(\n","    model = model,\n","    args = training_args,\n","    train_dataset = data_encodings['train'],\n","    eval_dataset = data_encodings['validation'],\n","    compute_metrics = compute_metrics_for_regression,\n","    callbacks=[EarlyStoppingCallback(5, 0.0)]\n",")\n","\n","# Train the model\n","trainer.train()"],"metadata":{"id":"baBlLozYwsH9","executionInfo":{"status":"ok","timestamp":1684600125654,"user_tz":-120,"elapsed":105319,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"e8aca90f-12d0-4614-8bf8-56975849f361"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.1067870482802391, 'eval_mse': 0.1067870482802391, 'eval_rmse': 0.32678288221359253, 'eval_mae': 0.2789109945297241, 'eval_r2': 0.0037718411396771012, 'eval_smape': 121.75481499565971, 'eval_runtime': 0.2649, 'eval_samples_per_second': 67.962, 'eval_steps_per_second': 11.327, 'epoch': 1.0}\n","{'eval_loss': 0.14606669545173645, 'eval_mse': 0.14606669545173645, 'eval_rmse': 0.38218674063682556, 'eval_mae': 0.32060307264328003, 'eval_r2': -0.3626723418496869, 'eval_smape': 105.16898600260416, 'eval_runtime': 0.2568, 'eval_samples_per_second': 70.101, 'eval_steps_per_second': 11.684, 'epoch': 2.0}\n","{'eval_loss': 0.11814820766448975, 'eval_mse': 0.11814820766448975, 'eval_rmse': 0.3437269330024719, 'eval_mae': 0.2870770990848541, 'eval_r2': -0.1022176706940141, 'eval_smape': 105.78696017795139, 'eval_runtime': 0.2527, 'eval_samples_per_second': 71.219, 'eval_steps_per_second': 11.87, 'epoch': 3.0}\n","{'eval_loss': 0.11423083394765854, 'eval_mse': 0.11423083394765854, 'eval_rmse': 0.3379805088043213, 'eval_mae': 0.28152862191200256, 'eval_r2': -0.06567199531164514, 'eval_smape': 105.77052815755208, 'eval_runtime': 0.2563, 'eval_samples_per_second': 70.243, 'eval_steps_per_second': 11.707, 'epoch': 4.0}\n","{'eval_loss': 0.11801629513502121, 'eval_mse': 0.11801629513502121, 'eval_rmse': 0.34353500604629517, 'eval_mae': 0.28709304332733154, 'eval_r2': -0.10098707448692368, 'eval_smape': 104.890380859375, 'eval_runtime': 0.2466, 'eval_samples_per_second': 72.982, 'eval_steps_per_second': 12.164, 'epoch': 5.0}\n","{'eval_loss': 0.0940752923488617, 'eval_mse': 0.09407529979944229, 'eval_rmse': 0.3067169785499573, 'eval_mae': 0.26357850432395935, 'eval_r2': 0.12236107252544715, 'eval_smape': 106.16196017795139, 'eval_runtime': 0.2538, 'eval_samples_per_second': 70.909, 'eval_steps_per_second': 11.818, 'epoch': 6.0}\n","{'eval_loss': 0.08243228495121002, 'eval_mse': 0.08243229240179062, 'eval_rmse': 0.28711023926734924, 'eval_mae': 0.2427418977022171, 'eval_r2': 0.23098010033456495, 'eval_smape': 102.76341417100694, 'eval_runtime': 0.2475, 'eval_samples_per_second': 72.732, 'eval_steps_per_second': 12.122, 'epoch': 7.0}\n","{'train_runtime': 105.2727, 'train_samples_per_second': 17.383, 'train_steps_per_second': 2.28, 'train_loss': 0.17429792881011963, 'epoch': 7.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=112, training_loss=0.17429792881011963, metrics={'train_runtime': 105.2727, 'train_samples_per_second': 17.383, 'train_steps_per_second': 2.28, 'train_loss': 0.17429792881011963, 'epoch': 7.0})"]},"metadata":{},"execution_count":88}]},{"cell_type":"code","source":["trainer.evaluate()"],"metadata":{"id":"Mf19DwNAwutN","executionInfo":{"status":"ok","timestamp":1684600126179,"user_tz":-120,"elapsed":536,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"63fd3df1-cf27-42b9-e9af-167e1c2a2d39"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.14606669545173645, 'eval_mse': 0.14606669545173645, 'eval_rmse': 0.38218674063682556, 'eval_mae': 0.32060307264328003, 'eval_r2': -0.3626723418496869, 'eval_smape': 105.16898600260416, 'eval_runtime': 0.285, 'eval_samples_per_second': 63.155, 'eval_steps_per_second': 10.526, 'epoch': 7.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.14606669545173645,\n"," 'eval_mse': 0.14606669545173645,\n"," 'eval_rmse': 0.38218674063682556,\n"," 'eval_mae': 0.32060307264328003,\n"," 'eval_r2': -0.3626723418496869,\n"," 'eval_smape': 105.16898600260416,\n"," 'eval_runtime': 0.285,\n"," 'eval_samples_per_second': 63.155,\n"," 'eval_steps_per_second': 10.526,\n"," 'epoch': 7.0}"]},"metadata":{},"execution_count":89}]},{"cell_type":"code","source":["trainer.eval_dataset = data_encodings['test']\n","trainer.evaluate()"],"metadata":{"id":"8Nebpu_swxep","executionInfo":{"status":"ok","timestamp":1684600126648,"user_tz":-120,"elapsed":470,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"e579f888-f1c4-416f-e129-e58489963cfa"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.1921786516904831, 'eval_mse': 0.1921786069869995, 'eval_rmse': 0.43838179111480713, 'eval_mae': 0.42776575684547424, 'eval_r2': 0.006084581138411371, 'eval_smape': 100.79470563616071, 'eval_runtime': 0.4736, 'eval_samples_per_second': 73.907, 'eval_steps_per_second': 10.558, 'epoch': 7.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.1921786516904831,\n"," 'eval_mse': 0.1921786069869995,\n"," 'eval_rmse': 0.43838179111480713,\n"," 'eval_mae': 0.42776575684547424,\n"," 'eval_r2': 0.006084581138411371,\n"," 'eval_smape': 100.79470563616071,\n"," 'eval_runtime': 0.4736,\n"," 'eval_samples_per_second': 73.907,\n"," 'eval_steps_per_second': 10.558,\n"," 'epoch': 7.0}"]},"metadata":{},"execution_count":90}]},{"cell_type":"code","source":["def get_prediction(text):\n","    # prepare our text into tokenized sequence\n","    inputs = tokenizer(text, max_length=MAX_LEN, padding=\"max_length\", truncation=True, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model(**inputs)   #output is a tensor\n","    return outputs[0].item()    #we only have to return the value of the tensor by using item()"],"metadata":{"id":"SZbzOylrwzH9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred_test=[get_prediction(text) for text in dataset['test']['Text']]\n","# this list will contain the intimacy scoring for all texts in the test dataset\n","#for i in range(len(y_pred_test)):\n","#  print(y_pred_test[i],'\\t',dataset['test']['label'][i],'\\t', abs(float(y_pred_test[i])-float(dataset['test']['label'][i])))"],"metadata":{"id":"f_5Pjn6Yw0mZ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_pred_val=[get_prediction(text) for text in dataset['validation']['Text']]\n","# this list will contain the intimacy scoring for all texts in the test dataset\n","#for i in range(len(y_pred_val)):\n","#  print(y_pred_val[i],'\\t',dataset['validation']['label'][i],'\\t', abs(float(y_pred_val[i])-float(dataset['validation']['label'][i])))"],"metadata":{"id":"IK7O_EizyOiL"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","\n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')\n","\n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"],"metadata":{"id":"O77RpRDow2sp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["y_train = data_encodings['train']['label']\n","y_val = data_encodings['validation']['label']\n","y_test = data_encodings['test']['label']"],"metadata":{"id":"NardrTCEtfO7"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print_metrics(y_val, y_pred_val)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"vZb8IEGUytld","executionInfo":{"status":"ok","timestamp":1684600127522,"user_tz":-120,"elapsed":7,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"a974cd0d-8c25-4a8e-bfc8-2173287bc08b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.15|0.38|0.32|-0.36|105.17|0.39|\n"]}]},{"cell_type":"code","source":["print_metrics(y_test, y_pred_test)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1DzRQ5brtLn9","executionInfo":{"status":"ok","timestamp":1684600127523,"user_tz":-120,"elapsed":6,"user":{"displayName":"CARLOS RODRIGUEZ CALZADA","userId":"12667430431079591890"}},"outputId":"21d99158-ff4b-452b-95ad-8009c1cacfa0"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.19|0.44|0.43|0.01|100.79|0.30|\n"]}]}]}