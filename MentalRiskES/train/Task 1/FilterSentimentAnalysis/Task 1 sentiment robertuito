{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":55743,"status":"ok","timestamp":1684768348370,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"_BiM0RepL_H6","outputId":"d9ab18d3-2364-47bd-df75-bd1a1cf602d7"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":2,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19176,"status":"ok","timestamp":1684768367542,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"wCWqtrBkuBp9","outputId":"c9562ad1-f54d-4196-eb40-79b73de20abf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.12.0-py3-none-any.whl (474 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m474.6/474.6 kB\u001b[0m \u001b[31m9.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting transformers\n","  Downloading transformers-4.29.2-py3-none-any.whl (7.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.1/7.1 MB\u001b[0m \u001b[31m70.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting accelerate\n","  Downloading accelerate-0.19.0-py3-none-any.whl (219 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m219.1/219.1 kB\u001b[0m \u001b[31m25.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.22.4)\n","Requirement already satisfied: pyarrow>=8.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (9.0.0)\n","Collecting dill<0.3.7,>=0.3.0 (from datasets)\n","  Downloading dill-0.3.6-py3-none-any.whl (110 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m110.5/110.5 kB\u001b[0m \u001b[31m14.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (1.5.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.27.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.65.0)\n","Collecting xxhash (from datasets)\n","  Downloading xxhash-3.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m212.5/212.5 kB\u001b[0m \u001b[31m23.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting multiprocess (from datasets)\n","  Downloading multiprocess-0.70.14-py310-none-any.whl (134 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.3/134.3 kB\u001b[0m \u001b[31m16.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (2023.4.0)\n","Collecting aiohttp (from datasets)\n","  Downloading aiohttp-3.8.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.0 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.0/1.0 MB\u001b[0m \u001b[31m67.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting huggingface-hub<1.0.0,>=0.11.0 (from datasets)\n","  Downloading huggingface_hub-0.14.1-py3-none-any.whl (224 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m224.5/224.5 kB\u001b[0m \u001b[31m27.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (23.1)\n","Collecting responses<0.19 (from datasets)\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m107.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from accelerate) (5.9.5)\n","Requirement already satisfied: torch>=1.6.0 in /usr/local/lib/python3.10/dist-packages (from accelerate) (2.0.1+cu118)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (23.1.0)\n","Requirement already satisfied: charset-normalizer<4.0,>=2.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.0.12)\n","Collecting multidict<7.0,>=4.5 (from aiohttp->datasets)\n","  Downloading multidict-6.0.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.5/114.5 kB\u001b[0m \u001b[31m16.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting async-timeout<5.0,>=4.0.0a3 (from aiohttp->datasets)\n","  Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB)\n","Collecting yarl<2.0,>=1.0 (from aiohttp->datasets)\n","  Downloading yarl-1.9.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (268 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m268.8/268.8 kB\u001b[0m \u001b[31m32.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting frozenlist>=1.1.1 (from aiohttp->datasets)\n","  Downloading frozenlist-1.3.3-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (149 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m149.6/149.6 kB\u001b[0m \u001b[31m21.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting aiosignal>=1.1.2 (from aiohttp->datasets)\n","  Downloading aiosignal-1.3.1-py3-none-any.whl (7.6 kB)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0.0,>=0.11.0->datasets) (4.5.0)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (1.26.15)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (2022.12.7)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.19.0->datasets) (3.4)\n","Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (1.11.1)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1)\n","Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (3.1.2)\n","Requirement already satisfied: triton==2.0.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.6.0->accelerate) (2.0.0)\n","Requirement already satisfied: cmake in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (3.25.2)\n","Requirement already satisfied: lit in /usr/local/lib/python3.10/dist-packages (from triton==2.0.0->torch>=1.6.0->accelerate) (16.0.5)\n","Requirement already satisfied: python-dateutil>=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2022.7.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.1->pandas->datasets) (1.16.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2->torch>=1.6.0->accelerate) (2.1.2)\n","Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.6.0->accelerate) (1.3.0)\n","Installing collected packages: tokenizers, xxhash, multidict, frozenlist, dill, async-timeout, yarl, responses, multiprocess, huggingface-hub, aiosignal, transformers, aiohttp, datasets, accelerate\n","Successfully installed accelerate-0.19.0 aiohttp-3.8.4 aiosignal-1.3.1 async-timeout-4.0.2 datasets-2.12.0 dill-0.3.6 frozenlist-1.3.3 huggingface-hub-0.14.1 multidict-6.0.4 multiprocess-0.70.14 responses-0.18.0 tokenizers-0.13.3 transformers-4.29.2 xxhash-3.2.0 yarl-1.9.2\n"]}],"source":["!pip install datasets transformers accelerate"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17,"status":"ok","timestamp":1684768367543,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"13dCqvZhuxs_","outputId":"8d0ae510-bd77-4aed-b70d-6ab1b3f9056b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mon May 22 15:12:47 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   45C    P8    10W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["gpu_info = !nvidia-smi\n","gpu_info = '\\n'.join(gpu_info)\n","if gpu_info.find('failed') >= 0:\n","  print('Not connected to a GPU')\n","else:\n","  print(gpu_info)"]},{"cell_type":"code","execution_count":4,"metadata":{"executionInfo":{"elapsed":1839,"status":"ok","timestamp":1684768369371,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"4evkaVy1u46V"},"outputs":[],"source":["import transformers, datasets\n","transformers.logging.set_verbosity_error()\n","datasets.logging.set_verbosity_error()"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":279,"referenced_widgets":["1ce304844ee940b4b4b2aa7d3da83087","ad958a1f6f024487b23ddda33b4db109","7540ce776b1c436d9789ed9bd4f4a09d","4f057059f280483a8a68f33fe18bfe2d","6d238688d0234cbfb5564dc2bcd0f4b5","a32d6bb9b46e4464a7c60e6252d30ade","63e77395aab843639e55acda93c24ccb","65ad3a14681e48f6a1f3669137bebf87","372f4353e5e64a43a71827f54b3e45b1","96c10e5619a54f4e9255e0f1d52fd680","b3c2c0e5264b4edba9cd380832deaea8","a10ff6fd9fb04db7878a801ea96a6195","9824e463f40a43778b191a1e7f830c85","a91f6b350a974485ade698ed51cda4a6","c65c22a7152d486392914b01e8a63ba5","e1ee176d120f42468e9cd5102018a351","5ab17c699e344596b9fc80b3ba944fbd","1584d1a7f8344164b1cbfb7b1b2e905b","e16c87a91323466f9c1f5052f4edec88","b3bc79acbb95479a8df16213c726fc54","a17f533388a34856b661cfd6e89de244","e8840dc0bd3c46fb992cdbc7c7480ab2","f646a0ca31a0421e876c66fcce2196ba","4e5f408a80014f49911eb20624fe5c96","ad88f124e043447890b7d7acdf5f6ef9","3745007275584498b852300034b41d7f","7b5c5b897adf48fa8249cfb0dbe72e49","ab814f9319ce4df489617cb240973563","bcc7f7522d6540d8bf26526932f8b877","df210bc6ed1a4f5ca479c95379c7c9d0","42eff554846040babe178e7b3934c5c5","72c2f2f2502144e28082079339339938","e34f02f3109a4ba9bdc3e2dea4add9ee","81bdfc8a39054279a9a4dec98ea09baa","f88a2990921e46909c9aea8f8c7e9ce3","4b5fd0969afc425c891bb4297c21b0fe","7cb33940c46e4ad1b95e9f70c3d9b9e3","6bb849b9a444478889cda485176671d8","eb0f1e3942f949f58720cdf38ac345ab","7157daf04d7b453f919c427e51ba1939","48e9f9888fee47f79b49019b264309c2","38d13b9031484871b7cf88ed0779ba97","9236b49a51a94562bce356cc03f016af","e36366b38ecd4eeb82d5f34959e6c915"]},"executionInfo":{"elapsed":2947,"status":"ok","timestamp":1684768372316,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"FMiyJWAHMa4-","outputId":"908ac053-33bd-439a-ee2a-fc3650e64e40"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading and preparing dataset csv/default to /root/.cache/huggingface/datasets/csv/default-44ec41001f33bd24/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1...\n"]},{"output_type":"display_data","data":{"text/plain":["Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"1ce304844ee940b4b4b2aa7d3da83087"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a10ff6fd9fb04db7878a801ea96a6195"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split: 0 examples [00:00, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"f646a0ca31a0421e876c66fcce2196ba"}},"metadata":{}},{"output_type":"stream","name":"stdout","text":["Dataset csv downloaded and prepared to /root/.cache/huggingface/datasets/csv/default-44ec41001f33bd24/0.0.0/6954658bab30a358235fa864b05cf819af0e179325c740e4bc853bcc7ec513e1. Subsequent calls will reuse this data.\n"]},{"output_type":"display_data","data":{"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"81bdfc8a39054279a9a4dec98ea09baa"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 2628\n","    })\n","})"]},"metadata":{},"execution_count":5}],"source":["from datasets import load_dataset\n","\n","data_path = \"/content/drive/My Drive/TFG/MentalRiskES/train/Task 1/Sentiment Analysis/\"\n","dataset = load_dataset(\"csv\", data_files=data_path+\"train_sentiment_no_neutro_robertuito.csv\")\n","dataset"]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":22,"status":"ok","timestamp":1684768372318,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"0SxeW28IM7Va","outputId":"aca541f6-e84d-4717-97ec-9c3a5e4a8f82"},"outputs":[{"output_type":"stream","name":"stdout","text":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 1839\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 789\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 528\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 261\n","    })\n","})\n","DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 1839\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 528\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label'],\n","        num_rows: 261\n","    })\n","})\n"]}],"source":["dataset = dataset[\"train\"].train_test_split(test_size=0.3, seed=42)\n","print(dataset)\n","\n","aux_dataset = dataset[\"test\"].train_test_split(test_size=0.33, seed=42)\n","print(aux_dataset)\n","\n","dataset['validation']=aux_dataset['test']\n","dataset['test']=aux_dataset['train']\n","del(aux_dataset)\n","print(dataset)"]},{"cell_type":"code","source":["data_validation = dataset[\"validation\"]"],"metadata":{"id":"2k5ab-5CG3al","executionInfo":{"status":"ok","timestamp":1684768372318,"user_tz":-120,"elapsed":17,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":17,"status":"ok","timestamp":1684768372319,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"2Z_fyU-Eunev","outputId":"42275411-cbc8-441f-e444-f23f6e83db98"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'Unnamed: 0.1': 0,\n"," 'Unnamed: 0': 3173,\n"," 'Message': 'Y me venía con esto',\n"," 'Subject': 'subject179',\n"," 'label beto': 'NEU',\n"," 'score beto': 0.9931249618530272,\n"," 'label robertuito': 'NEG',\n"," 'score robertuito': 0.8379411697387695,\n"," 'label': 0.2}"]},"metadata":{},"execution_count":8}],"source":["dataset['train'][0]"]},{"cell_type":"code","execution_count":93,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":204,"status":"ok","timestamp":1684773493005,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"-MuWGUZOvBJu","outputId":"d8ecde93-99cf-436e-dfa4-0e0d2ec37a60"},"outputs":[{"output_type":"stream","name":"stdout","text":["Using model: xlm-roberta-base\n"]}],"source":["# MODEL_NAME='bert-base-multilingual-uncased'\n","\n","# XLM-T: This is a XLM-Roberta-base model trained on ~198M multilingual tweets\n","# MODEL_NAME= \"cardiffnlp/twitter-xlm-roberta-base\"\n","\n","# XLM-R: XLM-RoBERTa model pre-trained on 2.5TB of filtered CommonCrawl data containing 100 languages.\n","MODEL_NAME= \"xlm-roberta-base\"\n","\n","# DistillBERT: a distilled version of the BERT base multilingual model. The model is trained on the concatenation of Wikipedia in 104 different languages\n","# The model has 6 layers, 768 dimension and 12 heads, totalizing 134M parameters (compared to 177M parameters for mBERT-base). \n","# On average, this model, referred to as DistilmBERT, is twice as fast as mBERT-base.\n","# MODEL_NAME= \"distilbert-base-multilingual-cased\"\n","\n","# MiniLM:Multilingual MiniLM uses the same tokenizer as XLM-R\n","# MODEL_NAME= \"microsoft/Multilingual-MiniLM-L12-H384\"\n","\n","print('Using model:', MODEL_NAME)"]},{"cell_type":"code","execution_count":94,"metadata":{"executionInfo":{"elapsed":1648,"status":"ok","timestamp":1684773494837,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"ljpBXXWTvF6b"},"outputs":[],"source":["from transformers import AutoTokenizer\n","\n","if 'MiniLM' in MODEL_NAME:\n","    # we must load the tokenizer of XLM-R\n","    tokenizer = AutoTokenizer.from_pretrained(\"xlm-roberta-base\")\n","else: \n","    tokenizer = AutoTokenizer.from_pretrained(MODEL_NAME)\n"]},{"cell_type":"code","execution_count":95,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1030,"status":"ok","timestamp":1684773495865,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"Fo_-iSvrvIfk","outputId":"2f85270b-3845-4eb8-c3cd-00039453fa5c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["count    1839.000000\n","mean       23.593257\n","std        59.758918\n","min         5.000000\n","25%        10.000000\n","50%        15.000000\n","75%        23.000000\n","85%        29.000000\n","90%        36.000000\n","95%        49.100000\n","99%       113.240000\n","max      1344.000000\n","dtype: float64"]},"metadata":{},"execution_count":95}],"source":["len_train_texts = [len(tokenizer(text).input_ids) for text in dataset['train']['Message']]\n","\n","import pandas as pd\n","df=pd.Series(len_train_texts)\n","df.describe(percentiles=[0.25, 0.50, 0.75, 0.85, 0.90, 0.95, 0.99])"]},{"cell_type":"code","execution_count":96,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":273,"referenced_widgets":["c572e3c0cc054cf48e25d8577342ac39","5d055d8daab14b6a942102b5ae9cfc41","6942ee799063486cb1c0d1ca60adc13c","a9ff0ced669b4ad681e81960a768b48f","ac5934f6e353459d80cb4eb5ff28a5b4","0bcf5ff9ff2047b08124e5f4b3c9024f","23293fc0b632442ab33237221ddb1f59","1f33b79ecd0040249174bb179083fd37","03d29b0e8f4845e4a4233b0d98cde083","c97b730414134dc9ada88704df3b0d7b","632f7b14a1104b139a595e7a6db4fbf7"]},"executionInfo":{"elapsed":635,"status":"ok","timestamp":1684773496479,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"MkV_0THcvUVE","outputId":"51bc0d41-b166-40d4-cf89-7626ee2f562b"},"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/528 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"c572e3c0cc054cf48e25d8577342ac39"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 1839\n","    })\n","    test: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 528\n","    })\n","    validation: Dataset({\n","        features: ['Unnamed: 0.1', 'Unnamed: 0', 'Message', 'Subject', 'label beto', 'score beto', 'label robertuito', 'score robertuito', 'label', 'input_ids', 'attention_mask'],\n","        num_rows: 261\n","    })\n","})"]},"metadata":{},"execution_count":96}],"source":["MAX_LEN = 128\n","\n","def tokenize(examples):\n","    ## it applies the tokenizer on the dataset in its field text\n","    # we could add max_length = MAX_LENGHT, but in this case is not neccesary because MAX_LENGTH is already 512, the maximum length allowed by the model\n","    return tokenizer(examples[\"Message\"], truncation=True, max_length=MAX_LEN, padding='max_length')\n","\n","\n","data_encodings=dataset.map(tokenize, batched=True)\n","data_encodings"]},{"cell_type":"code","execution_count":97,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1684773496480,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"_A3LcmxMwgo4","outputId":"209f1525-a993-447e-921c-403d0466b91f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 1839\n","    })\n","    test: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 528\n","    })\n","    validation: Dataset({\n","        features: ['label', 'input_ids', 'attention_mask'],\n","        num_rows: 261\n","    })\n","})"]},"metadata":{},"execution_count":97}],"source":["data_encodings = data_encodings.remove_columns(['Unnamed: 0.1','Unnamed: 0','Subject','Message', 'label beto', 'score beto', 'label robertuito', 'score robertuito'])\n","data_encodings"]},{"cell_type":"code","execution_count":98,"metadata":{"executionInfo":{"elapsed":8880,"status":"ok","timestamp":1684773505357,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"o4YciE87wXsR"},"outputs":[],"source":["from transformers import AutoModelForSequenceClassification\n","# As num_labes is 1, the AutoModelForSequenceClassification will trigger the linear regression and use MSELoss() as the loss function automatically.\n","model = AutoModelForSequenceClassification.from_pretrained(MODEL_NAME, num_labels = 1).to(\"cuda\")"]},{"cell_type":"code","execution_count":99,"metadata":{"executionInfo":{"elapsed":13,"status":"ok","timestamp":1684773505357,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"Kn79dWOFwZxe"},"outputs":[],"source":["import numpy as np\n","from sklearn.metrics import mean_squared_error, r2_score, mean_squared_error, mean_absolute_error\n","from scipy import stats\n","\n","def compute_metrics_for_regression(eval_pred):\n","    logits, labels = eval_pred\n","    labels = labels.reshape(-1, 1)\n","\n","    # loss metrics\n","    mse = mean_squared_error(labels, logits)\n","    rmse = mean_squared_error(labels, logits, squared=False)\n","    mae = mean_absolute_error(labels, logits)\n","    smape = 1/len(labels) * np.sum(2 * np.abs(logits-labels) / (np.abs(labels) + np.abs(logits))*100)\n","    # performance metrics\n","    r2 = r2_score(labels, logits)\n","    # pearson=stats.pearsonr(labels, logits)[0]\n","\n","    # we return a dictionary with all metrics\n","    # return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape, \"pearson\": pearson}\n","    return {\"mse\": mse, \"rmse\": rmse, \"mae\": mae, \"r2\": r2, \"smape\": smape}"]},{"cell_type":"code","execution_count":100,"metadata":{"executionInfo":{"elapsed":13,"status":"ok","timestamp":1684773505358,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"},"user_tz":-120},"id":"pL_uOTjYwcSY"},"outputs":[],"source":["from transformers import TrainingArguments\n","\n","\n","NUM_EPOCHS = 15 # we recommend at least 3\n","\n","# Specifiy the arguments for the trainer  \n","training_args = TrainingArguments(\n","    output_dir ='./results',          \n","    num_train_epochs = NUM_EPOCHS,     \n","    per_device_train_batch_size = 8, # 128 in the paper   \n","    per_device_eval_batch_size = 8,   \n","    weight_decay = 0.01,               \n","    learning_rate = 2e-5,  # 0.001 in the paper,\n","    logging_dir = './logs',            \n","    save_total_limit = 10,\n","    load_best_model_at_end = True,     \n","    metric_for_best_model = 'rmse',    \n","    evaluation_strategy = \"epoch\",  # steps in the paper\n","    save_strategy = \"epoch\",    # steps in the paper\n","    report_to = 'all',\n",") "]},{"cell_type":"code","execution_count":101,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"baBlLozYwsH9","outputId":"998d58e1-b60f-4adb-c513-1637926a7ea5","executionInfo":{"status":"ok","timestamp":1684774507640,"user_tz":-120,"elapsed":1002295,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:407: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n"]},{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.17698095738887787, 'eval_mse': 0.17698095738887787, 'eval_rmse': 0.42069104313850403, 'eval_mae': 0.39229708909988403, 'eval_r2': -4.9734564042225315e-05, 'eval_smape': 96.6807052203065, 'eval_runtime': 1.7969, 'eval_samples_per_second': 145.253, 'eval_steps_per_second': 18.365, 'epoch': 1.0}\n","{'eval_loss': 0.17711982131004333, 'eval_mse': 0.17711982131004333, 'eval_rmse': 0.4208560585975647, 'eval_mae': 0.3912007212638855, 'eval_r2': -0.0008343582815537598, 'eval_smape': 97.187814295977, 'eval_runtime': 1.7982, 'eval_samples_per_second': 145.148, 'eval_steps_per_second': 18.352, 'epoch': 2.0}\n","{'loss': 0.2018, 'learning_rate': 1.710144927536232e-05, 'epoch': 2.17}\n","{'eval_loss': 0.17859044671058655, 'eval_mse': 0.17859046161174774, 'eval_rmse': 0.4225996434688568, 'eval_mae': 0.38915225863456726, 'eval_r2': -0.009144450283603112, 'eval_smape': 98.07708482998083, 'eval_runtime': 1.8165, 'eval_samples_per_second': 143.683, 'eval_steps_per_second': 18.167, 'epoch': 3.0}\n","{'eval_loss': 0.18152889609336853, 'eval_mse': 0.18152889609336853, 'eval_rmse': 0.42606207728385925, 'eval_mae': 0.38716208934783936, 'eval_r2': -0.02574845458674191, 'eval_smape': 98.91445162835248, 'eval_runtime': 1.7957, 'eval_samples_per_second': 145.345, 'eval_steps_per_second': 18.377, 'epoch': 4.0}\n","{'loss': 0.1916, 'learning_rate': 1.420289855072464e-05, 'epoch': 4.35}\n","{'eval_loss': 0.1769808679819107, 'eval_mse': 0.1769808679819107, 'eval_rmse': 0.42069095373153687, 'eval_mae': 0.39233142137527466, 'eval_r2': -4.9217378499388786e-05, 'eval_smape': 96.66943546455938, 'eval_runtime': 1.7931, 'eval_samples_per_second': 145.556, 'eval_steps_per_second': 18.404, 'epoch': 5.0}\n","{'eval_loss': 0.17973238229751587, 'eval_mse': 0.17973236739635468, 'eval_rmse': 0.4239485561847687, 'eval_mae': 0.3882565498352051, 'eval_r2': -0.015597017862676088, 'eval_smape': 98.4614239104406, 'eval_runtime': 1.7954, 'eval_samples_per_second': 145.369, 'eval_steps_per_second': 18.38, 'epoch': 6.0}\n","{'loss': 0.1877, 'learning_rate': 1.1304347826086957e-05, 'epoch': 6.52}\n","{'eval_loss': 0.18295374512672424, 'eval_mse': 0.18295374512672424, 'eval_rmse': 0.427730917930603, 'eval_mae': 0.38645055890083313, 'eval_r2': -0.0337996675733403, 'eval_smape': 99.20833333333333, 'eval_runtime': 1.8226, 'eval_samples_per_second': 143.202, 'eval_steps_per_second': 18.106, 'epoch': 7.0}\n","{'eval_loss': 0.17709636688232422, 'eval_mse': 0.17709636688232422, 'eval_rmse': 0.4208281934261322, 'eval_mae': 0.39126574993133545, 'eval_r2': -0.0007019737870050946, 'eval_smape': 97.14893887691571, 'eval_runtime': 1.8243, 'eval_samples_per_second': 143.071, 'eval_steps_per_second': 18.089, 'epoch': 8.0}\n","{'loss': 0.1851, 'learning_rate': 8.405797101449275e-06, 'epoch': 8.7}\n","{'eval_loss': 0.17728373408317566, 'eval_mse': 0.17728373408317566, 'eval_rmse': 0.4210507571697235, 'eval_mae': 0.3907943665981293, 'eval_r2': -0.0017606313187237266, 'eval_smape': 97.35635177203065, 'eval_runtime': 1.8012, 'eval_samples_per_second': 144.906, 'eval_steps_per_second': 18.321, 'epoch': 9.0}\n","{'eval_loss': 0.17804557085037231, 'eval_mse': 0.17804557085037231, 'eval_rmse': 0.4219544529914856, 'eval_mae': 0.3896944224834442, 'eval_r2': -0.006065510504819516, 'eval_smape': 97.841250598659, 'eval_runtime': 1.8296, 'eval_samples_per_second': 142.657, 'eval_steps_per_second': 18.037, 'epoch': 10.0}\n","{'loss': 0.1844, 'learning_rate': 5.507246376811595e-06, 'epoch': 10.87}\n","{'eval_loss': 0.1770727038383484, 'eval_mse': 0.17707271873950958, 'eval_rmse': 0.4208000898361206, 'eval_mae': 0.3913477063179016, 'eval_r2': -0.0005682389392860365, 'eval_smape': 97.10883620689654, 'eval_runtime': 1.799, 'eval_samples_per_second': 145.08, 'eval_steps_per_second': 18.343, 'epoch': 11.0}\n","{'eval_loss': 0.17697128653526306, 'eval_mse': 0.17697128653526306, 'eval_rmse': 0.4206795394420624, 'eval_mae': 0.3920760452747345, 'eval_r2': 4.858304399779634e-06, 'eval_smape': 96.7814221144636, 'eval_runtime': 1.8113, 'eval_samples_per_second': 144.097, 'eval_steps_per_second': 18.219, 'epoch': 12.0}\n","{'train_runtime': 1002.1066, 'train_samples_per_second': 27.527, 'train_steps_per_second': 3.443, 'train_loss': 0.18965660039929377, 'epoch': 12.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=2760, training_loss=0.18965660039929377, metrics={'train_runtime': 1002.1066, 'train_samples_per_second': 27.527, 'train_steps_per_second': 3.443, 'train_loss': 0.18965660039929377, 'epoch': 12.0})"]},"metadata":{},"execution_count":101}],"source":["from transformers import Trainer, EarlyStoppingCallback\n","\n","# Call the Trainer\n","trainer = Trainer(\n","    model = model,                         \n","    args = training_args,                  \n","    train_dataset = data_encodings['train'],         \n","    eval_dataset = data_encodings['validation'],          \n","    compute_metrics = compute_metrics_for_regression,    \n","    callbacks=[EarlyStoppingCallback(5, 0.0)] \n",")\n","\n","# Train the model\n","trainer.train()"]},{"cell_type":"code","execution_count":102,"metadata":{"id":"Mf19DwNAwutN","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684774508807,"user_tz":-120,"elapsed":1178,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"a1240c59-0957-4980-df0b-bfe6cdca0560"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.18295374512672424, 'eval_mse': 0.18295374512672424, 'eval_rmse': 0.427730917930603, 'eval_mae': 0.38645055890083313, 'eval_r2': -0.0337996675733403, 'eval_smape': 99.20833333333333, 'eval_runtime': 1.8366, 'eval_samples_per_second': 142.108, 'eval_steps_per_second': 17.968, 'epoch': 12.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.18295374512672424,\n"," 'eval_mse': 0.18295374512672424,\n"," 'eval_rmse': 0.427730917930603,\n"," 'eval_mae': 0.38645055890083313,\n"," 'eval_r2': -0.0337996675733403,\n"," 'eval_smape': 99.20833333333333,\n"," 'eval_runtime': 1.8366,\n"," 'eval_samples_per_second': 142.108,\n"," 'eval_steps_per_second': 17.968,\n"," 'epoch': 12.0}"]},"metadata":{},"execution_count":102}],"source":["trainer.evaluate()"]},{"cell_type":"code","execution_count":103,"metadata":{"id":"8Nebpu_swxep","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684774512327,"user_tz":-120,"elapsed":3524,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"c6b2e122-b0e4-4b11-8446-740865d35ae0"},"outputs":[{"output_type":"stream","name":"stdout","text":["{'eval_loss': 0.17519894242286682, 'eval_mse': 0.17519894242286682, 'eval_rmse': 0.4185677170753479, 'eval_mae': 0.3785930275917053, 'eval_r2': -0.011929362179942338, 'eval_smape': 101.32329397490531, 'eval_runtime': 3.4934, 'eval_samples_per_second': 151.141, 'eval_steps_per_second': 18.893, 'epoch': 12.0}\n"]},{"output_type":"execute_result","data":{"text/plain":["{'eval_loss': 0.17519894242286682,\n"," 'eval_mse': 0.17519894242286682,\n"," 'eval_rmse': 0.4185677170753479,\n"," 'eval_mae': 0.3785930275917053,\n"," 'eval_r2': -0.011929362179942338,\n"," 'eval_smape': 101.32329397490531,\n"," 'eval_runtime': 3.4934,\n"," 'eval_samples_per_second': 151.141,\n"," 'eval_steps_per_second': 18.893,\n"," 'epoch': 12.0}"]},"metadata":{},"execution_count":103}],"source":["trainer.eval_dataset = data_encodings['test']\n","trainer.evaluate()"]},{"cell_type":"code","execution_count":104,"metadata":{"id":"SZbzOylrwzH9","executionInfo":{"status":"ok","timestamp":1684774512327,"user_tz":-120,"elapsed":4,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["def get_prediction(text):\n","    # prepare our text into tokenized sequence\n","    inputs = tokenizer(text, max_length=MAX_LEN, padding=\"max_length\", truncation=True, return_tensors=\"pt\").to(\"cuda\")\n","    outputs = model(**inputs)   #output is a tensor\n","    return outputs[0].item()    #we only have to return the value of the tensor by using item()"]},{"cell_type":"code","execution_count":105,"metadata":{"id":"f_5Pjn6Yw0mZ","executionInfo":{"status":"ok","timestamp":1684774516350,"user_tz":-120,"elapsed":4026,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["y_pred=[get_prediction(text) for text in dataset['validation']['Message']]"]},{"cell_type":"code","execution_count":106,"metadata":{"id":"O77RpRDow2sp","executionInfo":{"status":"ok","timestamp":1684774516350,"user_tz":-120,"elapsed":9,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["# from sklearn.metrics import explained_variance_score\n","\n","def print_metrics(y_test, y_pred, lang=''):\n","    # print(\"Final results on the whole test dataset\")\n","    print('|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|')\n","    print('|---|---|---|---|---|---|---|')\n","\n","    mse = mean_squared_error(y_test, y_pred)\n","    # print (\"MSE: \", \"{:.2f}\".format(mse), end=', ')\n","\n","    rmse = np.sqrt(mean_squared_error(y_test, y_pred))\n","    # print(\"RMSE: \", \"{:.2f}\".format(rmse), end=', ')\n","    \n","    mae = mean_absolute_error(y_test, y_pred)\n","    # print(\"MAE: \", \"{:.2f}\".format(mae), end=', ')\n","\n","    r2 = r2_score(y_test, y_pred)\n","    # print(\"R2: \", \"{:.2f}\".format(r2), end=', ')\n","\n","    diff=[label-pred for (label,pred) in zip(y_test,y_pred)]\n","    smape= 1/len(y_test) * np.sum(2 * np.abs(diff) / (np.abs(y_test) + np.abs(y_pred))*100)\n","    # print(\"SMAPE: \", \"{:.2f}\".format(smape), end=', ')\n","\n","    pearson=stats.pearsonr(y_test, y_pred)[0]\n","    # print(\"PEARSON: \", \"{:.2f}\".format(pearson))\n","    # print()\n","\n","    text_table=str('|')+lang+str('|') +\"{:.2f}\".format(mse) \\\n","                +str('|')+\"{:.2f}\".format(rmse) \\\n","                +str('|')+\"{:.2f}\".format(mae) \\\n","                +str('|')+\"{:.2f}\".format(r2) \\\n","                +str('|')+\"{:.2f}\".format(smape) \\\n","                +str('|')+\"{:.2f}\".format(pearson) + str('|')\n","\n","    print(text_table)\n","    # print()\n"]},{"cell_type":"code","execution_count":107,"metadata":{"id":"FkdfE-qW7y_9","executionInfo":{"status":"ok","timestamp":1684774516350,"user_tz":-120,"elapsed":8,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["y_train = data_encodings['train']['label']\n","y_val = data_encodings['validation']['label']\n","y_test = data_encodings['test']['label']"]},{"cell_type":"code","execution_count":108,"metadata":{"id":"yuJIBWvo7ddz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684774516351,"user_tz":-120,"elapsed":8,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"40cf780d-b380-4049-d226-06146bfd998e"},"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.18|0.43|0.39|-0.03|99.21|0.01|\n"]}],"source":["#print_metrics(y_test, y_pred)\n","print_metrics(y_val, y_pred)"]},{"cell_type":"code","execution_count":109,"metadata":{"id":"iKs5yju97KRp","executionInfo":{"status":"ok","timestamp":1684774516351,"user_tz":-120,"elapsed":7,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["with open(\"/content/drive/My Drive/TFG/MentalRiskES/train/Task 1/task1_gold_b.txt\") as file:\n","  final_labels_list = file.readlines()\n","final_labels_list\n","\n","final_labels = {}\n","\n","for label in final_labels_list:\n","  if label == final_labels_list[0]:\n","    continue\n","\n","  key = \"\"\n","  value = \"\"\n","\n","  comma = False\n","  for letter in label:\n","    if letter == '\\n':\n","      continue\n","    if letter == ',':\n","      comma = True\n","      continue\n","    if not comma:\n","      key += letter\n","    else:\n","      value += letter\n","  \n","  final_labels[key] = float(value)\n"]},{"cell_type":"code","execution_count":110,"metadata":{"id":"G_i-aKG96jfm","executionInfo":{"status":"ok","timestamp":1684774519761,"user_tz":-120,"elapsed":3416,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"outputs":[],"source":["predicted_labels = {}\n","for subject in final_labels:\n","  predicted_labels[subject] = 0\n","for index,text in enumerate(data_validation['Message']):\n","  pred = get_prediction(text)\n","  if pred > predicted_labels[data_validation[index]['Subject']]:\n","    predicted_labels[data_validation[index]['Subject']] = pred"]},{"cell_type":"code","source":["x = list(final_labels.values())\n","y = list(predicted_labels.values())"],"metadata":{"id":"ehxbMm23HTUz","executionInfo":{"status":"ok","timestamp":1684774519761,"user_tz":-120,"elapsed":14,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"execution_count":111,"outputs":[]},{"cell_type":"code","source":["for i in range(len(x)):\n","  if (x[i] == y[i]):\n","    y[i] += 0.001"],"metadata":{"id":"asujFnfuHXfQ","executionInfo":{"status":"ok","timestamp":1684774519762,"user_tz":-120,"elapsed":15,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}}},"execution_count":112,"outputs":[]},{"cell_type":"code","execution_count":113,"metadata":{"id":"gifmJ0JEJtcU","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1684774519762,"user_tz":-120,"elapsed":14,"user":{"displayName":"Charlie rodriguez","userId":"00794973294552919084"}},"outputId":"5250b774-6cb1-48a9-92e2-8bc7b593a230"},"outputs":[{"output_type":"stream","name":"stdout","text":["|   |MSE|RMSE|MAE|R2|SMAPE|PEARSON|\n","|---|---|---|---|---|---|---|\n","||0.20|0.45|0.37|-0.18|128.74|0.17|\n"]}],"source":["print_metrics(x,y)"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[]},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"},"widgets":{"application/vnd.jupyter.widget-state+json":{"1ce304844ee940b4b4b2aa7d3da83087":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_ad958a1f6f024487b23ddda33b4db109","IPY_MODEL_7540ce776b1c436d9789ed9bd4f4a09d","IPY_MODEL_4f057059f280483a8a68f33fe18bfe2d"],"layout":"IPY_MODEL_6d238688d0234cbfb5564dc2bcd0f4b5"}},"ad958a1f6f024487b23ddda33b4db109":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a32d6bb9b46e4464a7c60e6252d30ade","placeholder":"​","style":"IPY_MODEL_63e77395aab843639e55acda93c24ccb","value":"Downloading data files: 100%"}},"7540ce776b1c436d9789ed9bd4f4a09d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_65ad3a14681e48f6a1f3669137bebf87","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_372f4353e5e64a43a71827f54b3e45b1","value":1}},"4f057059f280483a8a68f33fe18bfe2d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_96c10e5619a54f4e9255e0f1d52fd680","placeholder":"​","style":"IPY_MODEL_b3c2c0e5264b4edba9cd380832deaea8","value":" 1/1 [00:00&lt;00:00, 33.19it/s]"}},"6d238688d0234cbfb5564dc2bcd0f4b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a32d6bb9b46e4464a7c60e6252d30ade":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"63e77395aab843639e55acda93c24ccb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"65ad3a14681e48f6a1f3669137bebf87":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"372f4353e5e64a43a71827f54b3e45b1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"96c10e5619a54f4e9255e0f1d52fd680":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b3c2c0e5264b4edba9cd380832deaea8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a10ff6fd9fb04db7878a801ea96a6195":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9824e463f40a43778b191a1e7f830c85","IPY_MODEL_a91f6b350a974485ade698ed51cda4a6","IPY_MODEL_c65c22a7152d486392914b01e8a63ba5"],"layout":"IPY_MODEL_e1ee176d120f42468e9cd5102018a351"}},"9824e463f40a43778b191a1e7f830c85":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5ab17c699e344596b9fc80b3ba944fbd","placeholder":"​","style":"IPY_MODEL_1584d1a7f8344164b1cbfb7b1b2e905b","value":"Extracting data files: 100%"}},"a91f6b350a974485ade698ed51cda4a6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_e16c87a91323466f9c1f5052f4edec88","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b3bc79acbb95479a8df16213c726fc54","value":1}},"c65c22a7152d486392914b01e8a63ba5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a17f533388a34856b661cfd6e89de244","placeholder":"​","style":"IPY_MODEL_e8840dc0bd3c46fb992cdbc7c7480ab2","value":" 1/1 [00:00&lt;00:00,  2.52it/s]"}},"e1ee176d120f42468e9cd5102018a351":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5ab17c699e344596b9fc80b3ba944fbd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1584d1a7f8344164b1cbfb7b1b2e905b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e16c87a91323466f9c1f5052f4edec88":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b3bc79acbb95479a8df16213c726fc54":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a17f533388a34856b661cfd6e89de244":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e8840dc0bd3c46fb992cdbc7c7480ab2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f646a0ca31a0421e876c66fcce2196ba":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_4e5f408a80014f49911eb20624fe5c96","IPY_MODEL_ad88f124e043447890b7d7acdf5f6ef9","IPY_MODEL_3745007275584498b852300034b41d7f"],"layout":"IPY_MODEL_7b5c5b897adf48fa8249cfb0dbe72e49"}},"4e5f408a80014f49911eb20624fe5c96":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_ab814f9319ce4df489617cb240973563","placeholder":"​","style":"IPY_MODEL_bcc7f7522d6540d8bf26526932f8b877","value":"Generating train split: "}},"ad88f124e043447890b7d7acdf5f6ef9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"info","description":"","description_tooltip":null,"layout":"IPY_MODEL_df210bc6ed1a4f5ca479c95379c7c9d0","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_42eff554846040babe178e7b3934c5c5","value":1}},"3745007275584498b852300034b41d7f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_72c2f2f2502144e28082079339339938","placeholder":"​","style":"IPY_MODEL_e34f02f3109a4ba9bdc3e2dea4add9ee","value":" 0/0 [00:00&lt;?, ? examples/s]"}},"7b5c5b897adf48fa8249cfb0dbe72e49":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"ab814f9319ce4df489617cb240973563":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bcc7f7522d6540d8bf26526932f8b877":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"df210bc6ed1a4f5ca479c95379c7c9d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"20px"}},"42eff554846040babe178e7b3934c5c5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"72c2f2f2502144e28082079339339938":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e34f02f3109a4ba9bdc3e2dea4add9ee":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"81bdfc8a39054279a9a4dec98ea09baa":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f88a2990921e46909c9aea8f8c7e9ce3","IPY_MODEL_4b5fd0969afc425c891bb4297c21b0fe","IPY_MODEL_7cb33940c46e4ad1b95e9f70c3d9b9e3"],"layout":"IPY_MODEL_6bb849b9a444478889cda485176671d8"}},"f88a2990921e46909c9aea8f8c7e9ce3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_eb0f1e3942f949f58720cdf38ac345ab","placeholder":"​","style":"IPY_MODEL_7157daf04d7b453f919c427e51ba1939","value":"100%"}},"4b5fd0969afc425c891bb4297c21b0fe":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_48e9f9888fee47f79b49019b264309c2","max":1,"min":0,"orientation":"horizontal","style":"IPY_MODEL_38d13b9031484871b7cf88ed0779ba97","value":1}},"7cb33940c46e4ad1b95e9f70c3d9b9e3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9236b49a51a94562bce356cc03f016af","placeholder":"​","style":"IPY_MODEL_e36366b38ecd4eeb82d5f34959e6c915","value":" 1/1 [00:00&lt;00:00, 47.75it/s]"}},"6bb849b9a444478889cda485176671d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"eb0f1e3942f949f58720cdf38ac345ab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7157daf04d7b453f919c427e51ba1939":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"48e9f9888fee47f79b49019b264309c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"38d13b9031484871b7cf88ed0779ba97":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9236b49a51a94562bce356cc03f016af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"e36366b38ecd4eeb82d5f34959e6c915":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c572e3c0cc054cf48e25d8577342ac39":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_5d055d8daab14b6a942102b5ae9cfc41","IPY_MODEL_6942ee799063486cb1c0d1ca60adc13c","IPY_MODEL_a9ff0ced669b4ad681e81960a768b48f"],"layout":"IPY_MODEL_ac5934f6e353459d80cb4eb5ff28a5b4"}},"5d055d8daab14b6a942102b5ae9cfc41":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0bcf5ff9ff2047b08124e5f4b3c9024f","placeholder":"​","style":"IPY_MODEL_23293fc0b632442ab33237221ddb1f59","value":"Map: 100%"}},"6942ee799063486cb1c0d1ca60adc13c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_1f33b79ecd0040249174bb179083fd37","max":528,"min":0,"orientation":"horizontal","style":"IPY_MODEL_03d29b0e8f4845e4a4233b0d98cde083","value":528}},"a9ff0ced669b4ad681e81960a768b48f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c97b730414134dc9ada88704df3b0d7b","placeholder":"​","style":"IPY_MODEL_632f7b14a1104b139a595e7a6db4fbf7","value":" 528/528 [00:00&lt;00:00, 3603.28 examples/s]"}},"ac5934f6e353459d80cb4eb5ff28a5b4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":null}},"0bcf5ff9ff2047b08124e5f4b3c9024f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23293fc0b632442ab33237221ddb1f59":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"1f33b79ecd0040249174bb179083fd37":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"03d29b0e8f4845e4a4233b0d98cde083":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"c97b730414134dc9ada88704df3b0d7b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"632f7b14a1104b139a595e7a6db4fbf7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}